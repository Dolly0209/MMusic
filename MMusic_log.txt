/Users/dolly/miniforge3/envs/py38/bin/python3 /Users/dolly/Documents/university/Graduation-Project/mymusicrec/DGRec/src/main_trainer.py
2023-02-13 10:55:51.489 | INFO     | __main__:main:61 - The main procedure has started with the following parameters:
2023-02-13 10:55:51.491 | INFO     | utils:log_param:33 - model               :                                             DGRec
2023-02-13 10:55:51.770 | INFO     | __main__:main:81 - The datasets are loaded
2023-02-13 10:55:51.770 | INFO     | __main__:main:84 - Training the model has begun with the following hyperparameters:
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - data_name           :                                              play
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - seed                :                                                 0
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - epochs              :                                                20
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - act                 :                                              relu
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - batch_size          :                                               100
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - num_users           :                                             30250
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - num_items           :                                            105149
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - num_times           :                                            421328
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - num_artists         :                                             21512
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - num_muses           :                                            104296
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - learning_rate       :                                              0.01
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - embedding_size      :                                                50
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - max_length          :                                                15
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - samples_1           :                                                10
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - samples_2           :                                                 5
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - dropout             :                                               0.3
2023-02-13 10:55:51.770 | INFO     | utils:log_param:33 - decay_rate          :                                              0.99
users: 15297	listening: 167488
users: 3470	listening: 46990
users: 8654	listening: 46990
epoch:   0%|          | 0/20 [00:00<?, ?it/s]
batch:   0%|          | 0/71 [00:00<?, ?it/s]
batch:   1%|▏         | 1/71 [01:21<1:35:30, 81.87s/it]
batch:   3%|▎         | 2/71 [01:29<43:40, 37.98s/it]  
batch:   4%|▍         | 3/71 [01:36<27:11, 23.99s/it]
batch:   6%|▌         | 4/71 [01:44<19:32, 17.51s/it]
batch:   7%|▋         | 5/71 [01:52<15:33, 14.14s/it]
batch:   8%|▊         | 6/71 [02:01<13:22, 12.34s/it]
batch:  10%|▉         | 7/71 [02:09<11:49, 11.08s/it]
batch:  11%|█▏        | 8/71 [03:24<33:00, 31.43s/it]
batch:  13%|█▎        | 9/71 [03:31<24:30, 23.71s/it]
batch:  14%|█▍        | 10/71 [03:38<18:57, 18.65s/it]
batch:  15%|█▌        | 11/71 [03:46<15:13, 15.22s/it]
batch:  17%|█▋        | 12/71 [03:53<12:37, 12.83s/it]
batch:  18%|█▊        | 13/71 [04:00<10:41, 11.06s/it]
batch:  20%|█▉        | 14/71 [04:07<09:17,  9.78s/it]
batch:  21%|██        | 15/71 [05:19<26:45, 28.66s/it]
batch:  23%|██▎       | 16/71 [05:26<20:15, 22.10s/it]
batch:  24%|██▍       | 17/71 [05:33<15:43, 17.48s/it]
batch:  25%|██▌       | 18/71 [05:39<12:35, 14.26s/it]
batch:  27%|██▋       | 19/71 [05:46<10:24, 12.01s/it]
batch:  28%|██▊       | 20/71 [05:53<08:52, 10.45s/it]
batch:  30%|██▉       | 21/71 [06:00<07:47,  9.35s/it]
batch:  31%|███       | 22/71 [07:11<22:52, 28.01s/it]
batch:  32%|███▏      | 23/71 [07:18<17:17, 21.61s/it]
batch:  34%|███▍      | 24/71 [07:25<13:25, 17.15s/it]
batch:  35%|███▌      | 25/71 [07:32<10:45, 14.03s/it]
batch:  37%|███▋      | 26/71 [07:38<08:53, 11.86s/it]
batch:  38%|███▊      | 27/71 [07:46<07:41, 10.48s/it]
batch:  39%|███▉      | 28/71 [07:53<06:52,  9.59s/it]
batch:  41%|████      | 29/71 [09:05<19:41, 28.14s/it]
batch:  42%|████▏     | 30/71 [09:11<14:51, 21.74s/it]
batch:  44%|████▎     | 31/71 [09:18<11:29, 17.24s/it]
batch:  45%|████▌     | 32/71 [09:25<09:09, 14.09s/it]
batch:  46%|████▋     | 33/71 [09:32<07:31, 11.89s/it]
batch:  48%|████▊     | 34/71 [09:38<06:22, 10.35s/it]
batch:  49%|████▉     | 35/71 [09:45<05:33,  9.28s/it]
batch:  51%|█████     | 36/71 [10:57<16:22, 28.06s/it]
batch:  52%|█████▏    | 37/71 [11:04<12:15, 21.64s/it]
batch:  54%|█████▎    | 38/71 [11:10<09:27, 17.19s/it]
batch:  55%|█████▍    | 39/71 [11:17<07:29, 14.06s/it]
batch:  56%|█████▋    | 40/71 [11:24<06:07, 11.86s/it]
batch:  58%|█████▊    | 41/71 [11:31<05:10, 10.34s/it]
batch:  59%|█████▉    | 42/71 [11:38<04:28,  9.27s/it]
batch:  61%|██████    | 43/71 [12:50<13:06, 28.09s/it]
batch:  62%|██████▏   | 44/71 [12:56<09:45, 21.70s/it]
batch:  63%|██████▎   | 45/71 [13:03<07:27, 17.21s/it]
batch:  65%|██████▍   | 46/71 [13:10<05:51, 14.07s/it]
batch:  66%|██████▌   | 47/71 [13:17<04:45, 11.91s/it]
batch:  68%|██████▊   | 48/71 [13:23<03:58, 10.37s/it]
batch:  69%|██████▉   | 49/71 [13:30<03:24,  9.29s/it]
batch:  70%|███████   | 50/71 [14:42<09:48, 28.02s/it]
batch:  72%|███████▏  | 51/71 [14:49<07:12, 21.64s/it]
batch:  73%|███████▎  | 52/71 [14:55<05:26, 17.18s/it]
batch:  75%|███████▍  | 53/71 [15:02<04:13, 14.08s/it]
batch:  76%|███████▌  | 54/71 [15:09<03:22, 11.88s/it]
batch:  77%|███████▋  | 55/71 [15:16<02:45, 10.36s/it]
batch:  79%|███████▉  | 56/71 [15:23<02:19,  9.32s/it]
batch:  80%|████████  | 57/71 [16:34<06:29, 27.85s/it]
batch:  82%|████████▏ | 58/71 [16:40<04:39, 21.49s/it]
batch:  83%|████████▎ | 59/71 [16:47<03:24, 17.05s/it]
batch:  85%|████████▍ | 60/71 [16:54<02:33, 13.95s/it]
batch:  86%|████████▌ | 61/71 [17:01<01:57, 11.77s/it]
batch:  87%|████████▋ | 62/71 [17:07<01:32, 10.25s/it]
batch:  89%|████████▊ | 63/71 [17:14<01:13,  9.20s/it]
batch:  90%|█████████ | 64/71 [18:25<03:13, 27.58s/it]
batch:  92%|█████████▏| 65/71 [18:31<02:07, 21.29s/it]
batch:  93%|█████████▎| 66/71 [18:38<01:24, 16.91s/it]
batch:  94%|█████████▍| 67/71 [18:45<00:55, 13.85s/it]
batch:  96%|█████████▌| 68/71 [18:51<00:35, 11.71s/it]
batch:  97%|█████████▋| 69/71 [18:58<00:20, 10.20s/it]
batch:  99%|█████████▊| 70/71 [19:05<00:09,  9.16s/it]
batch: 100%|██████████| 71/71 [20:15<00:00, 27.58s/it]
epoch:   5%|▌         | 1/20 [20:15<6:24:58, 1215.73s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 01: train loss: 11.43	  train recall@20: 0.01411	  train NDCG: 0.009028	  train precision: 0.007493	  train hit: 0.03606	  train mrr: 0.007936
Top10:Epoch 01: valid loss: 10.82	  valid recall@20: 0.02272	  valid NDCG: 0.01794	  valid precision: 0.02356	  valid hit: 0.115	  valid mrr: 0.01528

Top20:Epoch 01: train loss: 11.43	  train recall@20: 0.01903	  train NDCG: 0.01007	  train precision: 0.004923	  train hit: 0.0493	  train mrr: 0.008236
Top20:Epoch 01: valid loss: 10.82	  valid recall@20: 0.03482	  valid NDCG: 0.02184	  valid precision: 0.0185	  valid hit: 0.1732	  valid mrr: 0.01638

Top30:Epoch 01: train loss: 11.43	  train recall@20: 0.02223	  train NDCG: 0.01074	  train precision: 0.003845	  train hit: 0.05972	  train mrr: 0.008367
Top30:Epoch 01: valid loss: 10.82	  valid recall@20: 0.04205	  valid NDCG: 0.02368	  valid precision: 0.01475	  valid hit: 0.2118	  valid mrr: 0.01674


batch:   1%|▏         | 1/71 [01:10<1:22:10, 70.44s/it]
batch:   3%|▎         | 2/71 [01:17<37:49, 32.89s/it]  
batch:   4%|▍         | 3/71 [01:23<23:43, 20.94s/it]
batch:   6%|▌         | 4/71 [01:30<17:06, 15.32s/it]
batch:   7%|▋         | 5/71 [01:37<13:25, 12.21s/it]
batch:   8%|▊         | 6/71 [01:43<11:12, 10.34s/it]
batch:  10%|▉         | 7/71 [01:50<09:45,  9.15s/it]
batch:  11%|█▏        | 8/71 [03:01<30:12, 28.77s/it]
batch:  13%|█▎        | 9/71 [03:07<22:33, 21.84s/it]
batch:  14%|█▍        | 10/71 [03:14<17:26, 17.16s/it]
batch:  15%|█▌        | 11/71 [03:21<13:57, 13.97s/it]
batch:  17%|█▋        | 12/71 [03:28<11:34, 11.77s/it]
batch:  18%|█▊        | 13/71 [03:34<09:53, 10.24s/it]
batch:  20%|█▉        | 14/71 [03:41<08:43,  9.18s/it]
batch:  21%|██        | 15/71 [04:52<25:53, 27.74s/it]
batch:  23%|██▎       | 16/71 [04:58<19:36, 21.39s/it]
batch:  24%|██▍       | 17/71 [05:05<15:16, 16.98s/it]
batch:  25%|██▌       | 18/71 [05:12<12:16, 13.89s/it]
batch:  27%|██▋       | 19/71 [05:19<10:10, 11.74s/it]
batch:  28%|██▊       | 20/71 [05:25<08:41, 10.23s/it]
batch:  30%|██▉       | 21/71 [05:32<07:38,  9.18s/it]
batch:  31%|███       | 22/71 [06:43<22:40, 27.77s/it]
batch:  32%|███▏      | 23/71 [06:50<17:08, 21.42s/it]
batch:  34%|███▍      | 24/71 [06:56<13:18, 17.00s/it]
batch:  35%|███▌      | 25/71 [07:03<10:39, 13.91s/it]
batch:  37%|███▋      | 26/71 [07:10<08:48, 11.75s/it]
batch:  38%|███▊      | 27/71 [07:17<07:30, 10.24s/it]
batch:  39%|███▉      | 28/71 [07:23<06:34,  9.18s/it]
batch:  41%|████      | 29/71 [08:34<19:23, 27.71s/it]
batch:  42%|████▏     | 30/71 [08:41<14:36, 21.39s/it]
batch:  44%|████▎     | 31/71 [08:48<11:18, 16.97s/it]
batch:  45%|████▌     | 32/71 [08:54<09:02, 13.91s/it]
batch:  46%|████▋     | 33/71 [09:01<07:26, 11.76s/it]
batch:  48%|████▊     | 34/71 [09:08<06:19, 10.26s/it]
batch:  49%|████▉     | 35/71 [09:15<05:31,  9.21s/it]
batch:  51%|█████     | 36/71 [10:26<16:17, 27.93s/it]
batch:  52%|█████▏    | 37/71 [10:33<12:13, 21.58s/it]
batch:  54%|█████▎    | 38/71 [10:40<09:25, 17.13s/it]
batch:  55%|█████▍    | 39/71 [10:46<07:28, 14.01s/it]
batch:  56%|█████▋    | 40/71 [10:53<06:06, 11.83s/it]
batch:  58%|█████▊    | 41/71 [11:01<05:16, 10.55s/it]
batch:  59%|█████▉    | 42/71 [11:09<04:45,  9.85s/it]
batch:  61%|██████    | 43/71 [12:33<14:59, 32.13s/it]
batch:  62%|██████▏   | 44/71 [12:41<11:12, 24.92s/it]
batch:  63%|██████▎   | 45/71 [12:50<08:39, 19.96s/it]
batch:  65%|██████▍   | 46/71 [12:58<06:53, 16.55s/it]
batch:  66%|██████▌   | 47/71 [13:05<05:30, 13.76s/it]
batch:  68%|██████▊   | 48/71 [13:12<04:29, 11.73s/it]
batch:  69%|██████▉   | 49/71 [13:19<03:46, 10.31s/it]
batch:  70%|███████   | 50/71 [14:38<10:46, 30.81s/it]
batch:  72%|███████▏  | 51/71 [14:45<07:55, 23.76s/it]
batch:  73%|███████▎  | 52/71 [14:53<06:00, 18.97s/it]
batch:  75%|███████▍  | 53/71 [15:00<04:38, 15.49s/it]
batch:  76%|███████▌  | 54/71 [15:08<03:40, 12.98s/it]
batch:  77%|███████▋  | 55/71 [15:15<03:00, 11.27s/it]
batch:  79%|███████▉  | 56/71 [15:22<02:32, 10.14s/it]
batch:  80%|████████  | 57/71 [16:43<07:16, 31.16s/it]
batch:  82%|████████▏ | 58/71 [16:49<05:10, 23.87s/it]
batch:  83%|████████▎ | 59/71 [16:56<03:45, 18.75s/it]
batch:  85%|████████▍ | 60/71 [17:03<02:46, 15.16s/it]
batch:  86%|████████▌ | 61/71 [17:10<02:06, 12.65s/it]
batch:  87%|████████▋ | 62/71 [17:17<01:38, 10.90s/it]
batch:  89%|████████▊ | 63/71 [17:24<01:17,  9.70s/it]
batch:  90%|█████████ | 64/71 [18:42<03:33, 30.43s/it]
batch:  92%|█████████▏| 65/71 [18:49<02:20, 23.40s/it]
batch:  93%|█████████▎| 66/71 [18:56<01:32, 18.52s/it]
batch:  94%|█████████▍| 67/71 [19:04<01:01, 15.36s/it]
batch:  96%|█████████▌| 68/71 [19:12<00:38, 12.93s/it]
batch:  97%|█████████▋| 69/71 [19:19<00:22, 11.18s/it]
batch:  99%|█████████▊| 70/71 [19:26<00:10, 10.07s/it]
batch: 100%|██████████| 71/71 [20:45<00:00, 30.66s/it]
epoch:  15%|█▌        | 3/20 [41:01<3:40:00, 776.49s/it] 
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 02: train loss: 10.6	  train recall@20: 0.07559	  train NDCG: 0.03999	  train precision: 0.03448	  train hit: 0.1879	  train mrr: 0.03485
Top10:Epoch 02: valid loss: 10.05	  valid recall@20: 0.05206	  valid NDCG: 0.04114	  valid precision: 0.05338	  valid hit: 0.2315	  valid mrr: 0.03547

Top20:Epoch 02: train loss: 10.6	  train recall@20: 0.1004	  train NDCG: 0.04486	  train precision: 0.02245	  train hit: 0.2532	  train mrr: 0.03624
Top20:Epoch 02: valid loss: 10.05	  valid recall@20: 0.0701	  valid NDCG: 0.04631	  valid precision: 0.03549	  valid hit: 0.3065	  valid mrr: 0.03693

Top30:Epoch 02: train loss: 10.6	  train recall@20: 0.1177	  train NDCG: 0.04778	  train precision: 0.01757	  train hit: 0.2937	  train mrr: 0.03681
Top30:Epoch 02: valid loss: 10.05	  valid recall@20: 0.08093	  valid NDCG: 0.04942	  valid precision: 0.02762	  valid hit: 0.3482	  valid mrr: 0.03754


batch:   1%|▏         | 1/71 [01:15<1:27:59, 75.42s/it]
batch:   3%|▎         | 2/71 [01:22<40:29, 35.21s/it]  
batch:   4%|▍         | 3/71 [01:29<25:19, 22.35s/it]
batch:   6%|▌         | 4/71 [01:36<18:16, 16.37s/it]
batch:   7%|▋         | 5/71 [01:43<14:15, 12.97s/it]
batch:   8%|▊         | 6/71 [01:50<11:49, 10.92s/it]
batch:  10%|▉         | 7/71 [01:57<10:14,  9.60s/it]
batch:  11%|█▏        | 8/71 [03:13<32:15, 30.73s/it]
batch:  13%|█▎        | 9/71 [03:20<24:07, 23.34s/it]
batch:  14%|█▍        | 10/71 [03:27<18:40, 18.36s/it]
batch:  15%|█▌        | 11/71 [03:34<14:53, 14.89s/it]
batch:  17%|█▋        | 12/71 [03:41<12:19, 12.53s/it]
batch:  18%|█▊        | 13/71 [03:49<10:31, 10.88s/it]
batch:  20%|█▉        | 14/71 [03:56<09:21,  9.85s/it]
batch:  21%|██        | 15/71 [05:11<27:35, 29.56s/it]
batch:  23%|██▎       | 16/71 [05:19<20:57, 22.86s/it]
batch:  24%|██▍       | 17/71 [05:26<16:24, 18.23s/it]
batch:  25%|██▌       | 18/71 [05:33<13:13, 14.96s/it]
batch:  27%|██▋       | 19/71 [05:41<11:00, 12.70s/it]
batch:  28%|██▊       | 20/71 [05:48<09:29, 11.17s/it]
batch:  30%|██▉       | 21/71 [05:56<08:20, 10.02s/it]
batch:  31%|███       | 22/71 [07:12<24:19, 29.78s/it]
batch:  32%|███▏      | 23/71 [07:19<18:25, 23.02s/it]
batch:  34%|███▍      | 24/71 [07:26<14:18, 18.27s/it]
batch:  35%|███▌      | 25/71 [07:33<11:23, 14.86s/it]
batch:  37%|███▋      | 26/71 [07:40<09:21, 12.47s/it]
batch:  38%|███▊      | 27/71 [07:47<07:55, 10.81s/it]
batch:  39%|███▉      | 28/71 [07:54<06:54,  9.63s/it]
batch:  41%|████      | 29/71 [09:09<20:28, 29.25s/it]
batch:  42%|████▏     | 30/71 [09:16<15:24, 22.55s/it]
batch:  44%|████▎     | 31/71 [09:23<11:55, 17.89s/it]
batch:  45%|████▌     | 32/71 [09:30<09:35, 14.76s/it]
batch:  46%|████▋     | 33/71 [09:38<08:05, 12.77s/it]
batch:  48%|████▊     | 34/71 [09:46<07:01, 11.38s/it]
batch:  49%|████▉     | 35/71 [09:54<06:04, 10.13s/it]
batch:  51%|█████     | 36/71 [11:18<18:51, 32.34s/it]
batch:  52%|█████▏    | 37/71 [11:26<14:09, 24.99s/it]
batch:  54%|█████▎    | 38/71 [11:34<11:02, 20.08s/it]
batch:  55%|█████▍    | 39/71 [11:42<08:47, 16.48s/it]
batch:  56%|█████▋    | 40/71 [11:50<07:07, 13.79s/it]
batch:  58%|█████▊    | 41/71 [11:57<05:55, 11.87s/it]
batch:  59%|█████▉    | 42/71 [12:05<05:05, 10.52s/it]
batch:  61%|██████    | 43/71 [13:22<14:15, 30.56s/it]
batch:  62%|██████▏   | 44/71 [13:29<10:32, 23.43s/it]
batch:  63%|██████▎   | 45/71 [13:36<08:00, 18.46s/it]
batch:  65%|██████▍   | 46/71 [13:42<06:14, 14.97s/it]
batch:  66%|██████▌   | 47/71 [13:49<05:00, 12.50s/it]
batch:  68%|██████▊   | 48/71 [13:56<04:07, 10.76s/it]
batch:  69%|██████▉   | 49/71 [14:03<03:30,  9.56s/it]
batch:  70%|███████   | 50/71 [15:18<10:15, 29.31s/it]
batch:  72%|███████▏  | 51/71 [15:25<07:33, 22.69s/it]
batch:  73%|███████▎  | 52/71 [15:33<05:46, 18.22s/it]
batch:  75%|███████▍  | 53/71 [15:41<04:33, 15.22s/it]
batch:  76%|███████▌  | 54/71 [15:49<03:42, 13.09s/it]
batch:  77%|███████▋  | 55/71 [15:58<03:07, 11.73s/it]
batch:  79%|███████▉  | 56/71 [16:06<02:39, 10.61s/it]
batch:  80%|████████  | 57/71 [17:25<07:15, 31.09s/it]
batch:  82%|████████▏ | 58/71 [17:32<05:12, 24.01s/it]
batch:  83%|████████▎ | 59/71 [17:39<03:47, 18.93s/it]
batch:  85%|████████▍ | 60/71 [17:47<02:50, 15.47s/it]
batch:  86%|████████▌ | 61/71 [17:54<02:09, 12.95s/it]
batch:  87%|████████▋ | 62/71 [18:01<01:40, 11.13s/it]
batch:  89%|████████▊ | 63/71 [18:08<01:19,  9.96s/it]
batch:  90%|█████████ | 64/71 [19:29<03:39, 31.31s/it]
batch:  92%|█████████▏| 65/71 [19:38<02:27, 24.52s/it]
batch:  93%|█████████▎| 66/71 [19:46<01:38, 19.65s/it]
batch:  94%|█████████▍| 67/71 [19:54<01:04, 16.09s/it]
batch:  96%|█████████▌| 68/71 [20:02<00:40, 13.60s/it]
batch:  97%|█████████▋| 69/71 [20:09<00:23, 11.87s/it]
batch:  99%|█████████▊| 70/71 [20:17<00:10, 10.54s/it]
batch: 100%|██████████| 71/71 [21:34<00:00, 30.63s/it]
epoch:  25%|██▌       | 5/20 [1:02:36<2:57:31, 710.13s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 03: train loss: 10.25	  train recall@20: 0.1266	  train NDCG: 0.06319	  train precision: 0.05456	  train hit: 0.2985	  train mrr: 0.05462
Top10:Epoch 03: valid loss: 9.79	  valid recall@20: 0.06952	  valid NDCG: 0.05369	  valid precision: 0.06926	  valid hit: 0.3015	  valid mrr: 0.04631

Top20:Epoch 03: train loss: 10.25	  train recall@20: 0.1541	  train NDCG: 0.06907	  train precision: 0.0338	  train hit: 0.362	  train mrr: 0.05629
Top20:Epoch 03: valid loss: 9.79	  valid recall@20: 0.08789	  valid NDCG: 0.05934	  valid precision: 0.04396	  valid hit: 0.3718	  valid mrr: 0.04791

Top30:Epoch 03: train loss: 10.25	  train recall@20: 0.176	  train NDCG: 0.07293	  train precision: 0.02597	  train hit: 0.4117	  train mrr: 0.05704
Top30:Epoch 03: valid loss: 9.79	  valid recall@20: 0.1022	  valid NDCG: 0.06326	  valid precision: 0.03445	  valid hit: 0.4247	  valid mrr: 0.04867


batch:   1%|▏         | 1/71 [01:23<1:37:08, 83.26s/it]
batch:   3%|▎         | 2/71 [01:30<44:09, 38.40s/it]  
batch:   4%|▍         | 3/71 [01:37<27:11, 23.99s/it]
batch:   6%|▌         | 4/71 [01:43<19:13, 17.22s/it]
batch:   7%|▋         | 5/71 [01:51<15:05, 13.73s/it]
batch:   8%|▊         | 6/71 [01:58<12:28, 11.52s/it]
batch:  10%|▉         | 7/71 [02:06<10:53, 10.20s/it]
batch:  11%|█▏        | 8/71 [03:17<31:08, 29.66s/it]
batch:  13%|█▎        | 9/71 [03:24<23:11, 22.45s/it]
batch:  14%|█▍        | 10/71 [03:30<17:53, 17.60s/it]
batch:  15%|█▌        | 11/71 [03:37<14:16, 14.28s/it]
batch:  17%|█▋        | 12/71 [03:44<11:47, 11.98s/it]
batch:  18%|█▊        | 13/71 [03:51<10:02, 10.40s/it]
batch:  20%|█▉        | 14/71 [03:57<08:49,  9.29s/it]
batch:  21%|██        | 15/71 [05:07<25:47, 27.64s/it]
batch:  23%|██▎       | 16/71 [05:14<19:31, 21.31s/it]
batch:  24%|██▍       | 17/71 [05:21<15:13, 16.91s/it]
batch:  25%|██▌       | 18/71 [05:27<12:12, 13.83s/it]
batch:  27%|██▋       | 19/71 [05:34<10:07, 11.68s/it]
batch:  28%|██▊       | 20/71 [05:41<08:39, 10.18s/it]
batch:  30%|██▉       | 21/71 [05:47<07:36,  9.12s/it]
batch:  31%|███       | 22/71 [06:58<22:24, 27.43s/it]
batch:  32%|███▏      | 23/71 [07:04<16:57, 21.19s/it]
batch:  34%|███▍      | 24/71 [07:11<13:11, 16.85s/it]
batch:  35%|███▌      | 25/71 [07:18<10:45, 14.04s/it]
batch:  37%|███▋      | 26/71 [07:25<08:55, 11.89s/it]
batch:  38%|███▊      | 27/71 [07:32<07:35, 10.36s/it]
batch:  39%|███▉      | 28/71 [07:39<06:38,  9.26s/it]
batch:  41%|████      | 29/71 [08:52<19:59, 28.55s/it]
batch:  42%|████▏     | 30/71 [08:59<15:03, 22.05s/it]
batch:  44%|████▎     | 31/71 [09:06<11:40, 17.50s/it]
batch:  45%|████▌     | 32/71 [09:13<09:18, 14.32s/it]
batch:  46%|████▋     | 33/71 [09:20<07:38, 12.06s/it]
batch:  48%|████▊     | 34/71 [09:27<06:27, 10.47s/it]
batch:  49%|████▉     | 35/71 [09:33<05:37,  9.36s/it]
batch:  51%|█████     | 36/71 [10:43<16:03, 27.53s/it]
batch:  52%|█████▏    | 37/71 [10:50<12:04, 21.31s/it]
batch:  54%|█████▎    | 38/71 [10:57<09:18, 16.92s/it]
batch:  55%|█████▍    | 39/71 [11:03<07:23, 13.85s/it]
batch:  56%|█████▋    | 40/71 [11:10<06:03, 11.71s/it]
batch:  58%|█████▊    | 41/71 [11:17<05:06, 10.21s/it]
batch:  59%|█████▉    | 42/71 [11:24<04:25,  9.16s/it]
batch:  61%|██████    | 43/71 [12:35<12:58, 27.80s/it]
batch:  62%|██████▏   | 44/71 [12:42<09:39, 21.46s/it]
batch:  63%|██████▎   | 45/71 [12:48<07:22, 17.04s/it]
batch:  65%|██████▍   | 46/71 [12:55<05:48, 13.94s/it]
batch:  66%|██████▌   | 47/71 [13:02<04:42, 11.78s/it]
batch:  68%|██████▊   | 48/71 [13:08<03:54, 10.21s/it]
batch:  69%|██████▉   | 49/71 [13:15<03:20,  9.13s/it]
batch:  70%|███████   | 50/71 [14:23<09:21, 26.72s/it]
batch:  72%|███████▏  | 51/71 [14:29<06:53, 20.68s/it]
batch:  73%|███████▎  | 52/71 [14:36<05:12, 16.44s/it]
batch:  75%|███████▍  | 53/71 [14:42<04:02, 13.47s/it]
batch:  76%|███████▌  | 54/71 [14:49<03:13, 11.39s/it]
batch:  77%|███████▋  | 55/71 [14:55<02:38,  9.93s/it]
batch:  79%|███████▉  | 56/71 [15:02<02:13,  8.92s/it]
batch:  80%|████████  | 57/71 [16:09<06:10, 26.44s/it]
batch:  82%|████████▏ | 58/71 [16:16<04:25, 20.45s/it]
batch:  83%|████████▎ | 59/71 [16:22<03:15, 16.29s/it]
batch:  85%|████████▍ | 60/71 [16:29<02:27, 13.38s/it]
batch:  86%|████████▌ | 61/71 [16:35<01:53, 11.34s/it]
batch:  87%|████████▋ | 62/71 [16:42<01:29,  9.91s/it]
batch:  89%|████████▊ | 63/71 [16:49<01:11,  8.90s/it]
batch:  90%|█████████ | 64/71 [17:56<03:04, 26.39s/it]
batch:  92%|█████████▏| 65/71 [18:02<02:02, 20.42s/it]
batch:  93%|█████████▎| 66/71 [18:09<01:21, 16.26s/it]
batch:  94%|█████████▍| 67/71 [18:15<00:53, 13.34s/it]
batch:  96%|█████████▌| 68/71 [18:22<00:33, 11.30s/it]
batch:  97%|█████████▋| 69/71 [18:28<00:19,  9.87s/it]
batch:  99%|█████████▊| 70/71 [18:35<00:08,  8.87s/it]
batch: 100%|██████████| 71/71 [19:42<00:00, 26.34s/it]
epoch:  30%|███       | 6/20 [1:22:18<3:15:18, 837.03s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 04: train loss: 10.07	  train recall@20: 0.1567	  train NDCG: 0.08125	  train precision: 0.06682	  train hit: 0.3617	  train mrr: 0.07176
Top10:Epoch 04: valid loss: 9.677	  valid recall@20: 0.08652	  valid NDCG: 0.06729	  valid precision: 0.08524	  valid hit: 0.3665	  valid mrr: 0.05881

Top20:Epoch 04: train loss: 10.07	  train recall@20: 0.1879	  train NDCG: 0.08887	  train precision: 0.04149	  train hit: 0.4341	  train mrr: 0.07394
Top20:Epoch 04: valid loss: 9.677	  valid recall@20: 0.1101	  valid NDCG: 0.07465	  valid precision: 0.0544	  valid hit: 0.4491	  valid mrr: 0.06091

Top30:Epoch 04: train loss: 10.07	  train recall@20: 0.2149	  train NDCG: 0.09349	  train precision: 0.0318	  train hit: 0.4866	  train mrr: 0.07483
Top30:Epoch 04: valid loss: 9.677	  valid recall@20: 0.1267	  valid NDCG: 0.07879	  valid precision: 0.04171	  valid hit: 0.5041	  valid mrr: 0.06171


batch:   1%|▏         | 1/71 [01:07<1:18:32, 67.32s/it]
batch:   3%|▎         | 2/71 [01:13<36:16, 31.55s/it]  
batch:   4%|▍         | 3/71 [01:20<22:48, 20.13s/it]
batch:   6%|▌         | 4/71 [01:26<16:29, 14.76s/it]
batch:   7%|▋         | 5/71 [01:33<12:58, 11.80s/it]
batch:   8%|▊         | 6/71 [01:39<10:50, 10.01s/it]
batch:  10%|▉         | 7/71 [01:46<09:28,  8.88s/it]
batch:  11%|█▏        | 8/71 [02:53<28:49, 27.45s/it]
batch:  13%|█▎        | 9/71 [03:00<21:35, 20.90s/it]
batch:  14%|█▍        | 10/71 [03:06<16:45, 16.48s/it]
batch:  15%|█▌        | 11/71 [03:13<13:26, 13.45s/it]
batch:  17%|█▋        | 12/71 [03:19<11:09, 11.35s/it]
batch:  18%|█▊        | 13/71 [03:26<09:33,  9.89s/it]
batch:  20%|█▉        | 14/71 [03:32<08:25,  8.87s/it]
batch:  21%|██        | 15/71 [04:40<24:47, 26.55s/it]
batch:  23%|██▎       | 16/71 [04:47<18:49, 20.54s/it]
batch:  24%|██▍       | 17/71 [04:53<14:42, 16.35s/it]
batch:  25%|██▌       | 18/71 [05:00<11:52, 13.44s/it]
batch:  27%|██▋       | 19/71 [05:06<09:50, 11.36s/it]
batch:  28%|██▊       | 20/71 [05:13<08:26,  9.92s/it]
batch:  30%|██▉       | 21/71 [05:19<07:25,  8.90s/it]
batch:  31%|███       | 22/71 [06:27<21:34, 26.42s/it]
batch:  32%|███▏      | 23/71 [06:33<16:21, 20.45s/it]
batch:  34%|███▍      | 24/71 [06:40<12:46, 16.31s/it]
batch:  35%|███▌      | 25/71 [06:46<10:15, 13.38s/it]
batch:  37%|███▋      | 26/71 [06:53<08:29, 11.32s/it]
batch:  38%|███▊      | 27/71 [06:59<07:14,  9.88s/it]
batch:  39%|███▉      | 28/71 [07:06<06:21,  8.87s/it]
batch:  41%|████      | 29/71 [08:13<18:27, 26.38s/it]
batch:  42%|████▏     | 30/71 [08:20<13:56, 20.41s/it]
batch:  44%|████▎     | 31/71 [08:26<10:50, 16.25s/it]
batch:  45%|████▌     | 32/71 [08:33<08:39, 13.33s/it]
batch:  46%|████▋     | 33/71 [08:39<07:08, 11.29s/it]
batch:  48%|████▊     | 34/71 [08:46<06:05,  9.87s/it]
batch:  49%|████▉     | 35/71 [08:52<05:19,  8.87s/it]
batch:  51%|█████     | 36/71 [10:00<15:23, 26.38s/it]
batch:  52%|█████▏    | 37/71 [10:06<11:34, 20.41s/it]
batch:  54%|█████▎    | 38/71 [10:13<08:56, 16.25s/it]
batch:  55%|█████▍    | 39/71 [10:19<07:06, 13.34s/it]
batch:  56%|█████▋    | 40/71 [10:26<05:50, 11.29s/it]
batch:  58%|█████▊    | 41/71 [10:32<04:55,  9.86s/it]
batch:  59%|█████▉    | 42/71 [10:39<04:16,  8.86s/it]
batch:  61%|██████    | 43/71 [11:46<12:18, 26.39s/it]
batch:  62%|██████▏   | 44/71 [11:53<09:11, 20.43s/it]
batch:  63%|██████▎   | 45/71 [11:59<07:02, 16.27s/it]
batch:  65%|██████▍   | 46/71 [12:06<05:33, 13.34s/it]
batch:  66%|██████▌   | 47/71 [12:12<04:30, 11.29s/it]
batch:  68%|██████▊   | 48/71 [12:19<03:46,  9.86s/it]
batch:  69%|██████▉   | 49/71 [12:25<03:15,  8.86s/it]
batch:  70%|███████   | 50/71 [13:32<09:13, 26.37s/it]
batch:  72%|███████▏  | 51/71 [13:39<06:48, 20.42s/it]
batch:  73%|███████▎  | 52/71 [13:46<05:08, 16.26s/it]
batch:  75%|███████▍  | 53/71 [13:52<04:00, 13.35s/it]
batch:  76%|███████▌  | 54/71 [13:59<03:12, 11.31s/it]
batch:  77%|███████▋  | 55/71 [14:05<02:38,  9.88s/it]
batch:  79%|███████▉  | 56/71 [14:12<02:13,  8.87s/it]
batch:  80%|████████  | 57/71 [15:19<06:09, 26.37s/it]
batch:  82%|████████▏ | 58/71 [15:25<04:25, 20.41s/it]
batch:  83%|████████▎ | 59/71 [15:32<03:14, 16.24s/it]
batch:  85%|████████▍ | 60/71 [15:38<02:26, 13.33s/it]
batch:  86%|████████▌ | 61/71 [15:45<01:52, 11.29s/it]
batch:  87%|████████▋ | 62/71 [15:51<01:28,  9.86s/it]
batch:  89%|████████▊ | 63/71 [15:58<01:10,  8.86s/it]
batch:  90%|█████████ | 64/71 [17:05<03:04, 26.41s/it]
batch:  92%|█████████▏| 65/71 [17:12<02:02, 20.43s/it]
batch:  93%|█████████▎| 66/71 [17:18<01:21, 16.27s/it]
batch:  94%|█████████▍| 67/71 [17:25<00:53, 13.36s/it]
batch:  96%|█████████▌| 68/71 [17:32<00:33, 11.32s/it]
batch:  97%|█████████▋| 69/71 [17:38<00:19,  9.87s/it]
batch:  99%|█████████▊| 70/71 [17:45<00:08,  8.88s/it]
batch: 100%|██████████| 71/71 [18:52<00:00, 26.42s/it]
epoch:  40%|████      | 8/20 [1:41:11<2:23:53, 719.45s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 05: train loss: 9.939	  train recall@20: 0.1923	  train NDCG: 0.09757	  train precision: 0.08154	  train hit: 0.437	  train mrr: 0.08581
Top10:Epoch 05: valid loss: 9.517	  valid recall@20: 0.1037	  valid NDCG: 0.07918	  valid precision: 0.1012	  valid hit: 0.4353	  valid mrr: 0.06878

Top20:Epoch 05: train loss: 9.939	  train recall@20: 0.2317	  train NDCG: 0.1061	  train precision: 0.04993	  train hit: 0.5146	  train mrr: 0.08825
Top20:Epoch 05: valid loss: 9.517	  valid recall@20: 0.1308	  valid NDCG: 0.08749	  valid precision: 0.0641	  valid hit: 0.5159	  valid mrr: 0.07116

Top30:Epoch 05: train loss: 9.939	  train recall@20: 0.2614	  train NDCG: 0.1113	  train precision: 0.03788	  train hit: 0.568	  train mrr: 0.08926
Top30:Epoch 05: valid loss: 9.517	  valid recall@20: 0.1501	  valid NDCG: 0.09259	  valid precision: 0.04937	  valid hit: 0.5626	  valid mrr: 0.07215


batch:   1%|▏         | 1/71 [01:07<1:18:31, 67.31s/it]
batch:   3%|▎         | 2/71 [01:13<36:15, 31.53s/it]  
batch:   4%|▍         | 3/71 [01:20<22:48, 20.12s/it]
batch:   6%|▌         | 4/71 [01:26<16:29, 14.76s/it]
batch:   7%|▋         | 5/71 [01:33<12:58, 11.80s/it]
batch:   8%|▊         | 6/71 [01:39<10:50, 10.00s/it]
batch:  10%|▉         | 7/71 [01:46<09:27,  8.86s/it]
batch:  11%|█▏        | 8/71 [02:53<28:53, 27.52s/it]
batch:  13%|█▎        | 9/71 [03:00<21:38, 20.95s/it]
batch:  14%|█▍        | 10/71 [03:07<16:47, 16.52s/it]
batch:  15%|█▌        | 11/71 [03:13<13:27, 13.46s/it]
batch:  17%|█▋        | 12/71 [03:20<11:11, 11.38s/it]
batch:  18%|█▊        | 13/71 [03:26<09:36,  9.93s/it]
batch:  20%|█▉        | 14/71 [03:33<08:28,  8.92s/it]
batch:  21%|██        | 15/71 [04:41<25:01, 26.80s/it]
batch:  23%|██▎       | 16/71 [04:48<19:00, 20.73s/it]
batch:  24%|██▍       | 17/71 [04:54<14:50, 16.49s/it]
batch:  25%|██▌       | 18/71 [05:01<11:56, 13.52s/it]
batch:  27%|██▋       | 19/71 [05:07<09:53, 11.42s/it]
batch:  28%|██▊       | 20/71 [05:14<08:26,  9.94s/it]
batch:  30%|██▉       | 21/71 [05:21<07:27,  8.96s/it]
batch:  31%|███       | 22/71 [06:28<21:39, 26.53s/it]
batch:  32%|███▏      | 23/71 [06:35<16:25, 20.52s/it]
batch:  34%|███▍      | 24/71 [06:41<12:47, 16.33s/it]
batch:  35%|███▌      | 25/71 [06:48<10:16, 13.40s/it]
batch:  37%|███▋      | 26/71 [06:54<08:30, 11.34s/it]
batch:  38%|███▊      | 27/71 [07:01<07:15,  9.90s/it]
batch:  39%|███▉      | 28/71 [07:07<06:22,  8.89s/it]
batch:  41%|████      | 29/71 [08:15<18:29, 26.42s/it]
batch:  42%|████▏     | 30/71 [08:21<13:58, 20.44s/it]
batch:  44%|████▎     | 31/71 [08:28<10:51, 16.28s/it]
batch:  45%|████▌     | 32/71 [08:34<08:41, 13.36s/it]
batch:  46%|████▋     | 33/71 [08:41<07:10, 11.32s/it]
batch:  48%|████▊     | 34/71 [08:47<06:05,  9.89s/it]
batch:  49%|████▉     | 35/71 [08:54<05:20,  8.90s/it]
batch:  51%|█████     | 36/71 [10:01<15:24, 26.42s/it]
batch:  52%|█████▏    | 37/71 [10:08<11:35, 20.44s/it]
batch:  54%|█████▎    | 38/71 [10:14<08:57, 16.28s/it]
batch:  55%|█████▍    | 39/71 [10:21<07:07, 13.36s/it]
batch:  56%|█████▋    | 40/71 [10:27<05:50, 11.31s/it]
batch:  58%|█████▊    | 41/71 [10:34<04:56,  9.88s/it]
batch:  59%|█████▉    | 42/71 [10:41<04:17,  8.88s/it]
batch:  61%|██████    | 43/71 [11:48<12:20, 26.45s/it]
batch:  62%|██████▏   | 44/71 [11:54<09:12, 20.46s/it]
batch:  63%|██████▎   | 45/71 [12:01<07:03, 16.28s/it]
batch:  65%|██████▍   | 46/71 [12:08<05:34, 13.38s/it]
batch:  66%|██████▌   | 47/71 [12:14<04:32, 11.34s/it]
batch:  68%|██████▊   | 48/71 [12:21<03:47,  9.90s/it]
batch:  69%|██████▉   | 49/71 [12:27<03:15,  8.88s/it]
batch:  70%|███████   | 50/71 [13:35<09:14, 26.42s/it]
batch:  72%|███████▏  | 51/71 [13:41<06:48, 20.45s/it]
batch:  73%|███████▎  | 52/71 [13:48<05:09, 16.28s/it]
batch:  75%|███████▍  | 53/71 [13:54<04:00, 13.37s/it]
batch:  76%|███████▌  | 54/71 [14:01<03:12, 11.31s/it]
batch:  77%|███████▋  | 55/71 [14:07<02:38,  9.88s/it]
batch:  79%|███████▉  | 56/71 [14:14<02:13,  8.88s/it]
batch:  80%|████████  | 57/71 [15:24<06:19, 27.14s/it]
batch:  82%|████████▏ | 58/71 [15:30<04:33, 21.01s/it]
batch:  83%|████████▎ | 59/71 [15:37<03:20, 16.70s/it]
batch:  85%|████████▍ | 60/71 [15:44<02:30, 13.68s/it]
batch:  86%|████████▌ | 61/71 [15:50<01:55, 11.54s/it]
batch:  87%|████████▋ | 62/71 [15:57<01:30, 10.07s/it]
batch:  89%|████████▊ | 63/71 [16:03<01:12,  9.03s/it]
batch:  90%|█████████ | 64/71 [17:11<03:07, 26.77s/it]
batch:  92%|█████████▏| 65/71 [17:18<02:04, 20.70s/it]
batch:  93%|█████████▎| 66/71 [17:25<01:22, 16.47s/it]
batch:  94%|█████████▍| 67/71 [17:31<00:53, 13.49s/it]
batch:  96%|█████████▌| 68/71 [17:38<00:34, 11.41s/it]
batch:  97%|█████████▋| 69/71 [17:44<00:19,  9.94s/it]
batch:  99%|█████████▊| 70/71 [17:51<00:08,  8.94s/it]
batch: 100%|██████████| 71/71 [18:59<00:00, 26.65s/it]
epoch:  45%|████▌     | 9/20 [2:00:10<2:30:07, 818.84s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 06: train loss: 9.821	  train recall@20: 0.2226	  train NDCG: 0.1126	  train precision: 0.09442	  train hit: 0.4976	  train mrr: 0.09898
Top10:Epoch 06: valid loss: 9.344	  valid recall@20: 0.1243	  valid NDCG: 0.09417	  valid precision: 0.1215	  valid hit: 0.4959	  valid mrr: 0.08156

Top20:Epoch 06: train loss: 9.821	  train recall@20: 0.2695	  train NDCG: 0.1232	  train precision: 0.05848	  train hit: 0.5818	  train mrr: 0.102
Top20:Epoch 06: valid loss: 9.344	  valid recall@20: 0.1564	  valid NDCG: 0.1039	  valid precision: 0.07641	  valid hit: 0.5818	  valid mrr: 0.08435

Top30:Epoch 06: train loss: 9.821	  train recall@20: 0.3019	  train NDCG: 0.1292	  train precision: 0.04423	  train hit: 0.6373	  train mrr: 0.1032
Top30:Epoch 06: valid loss: 9.344	  valid recall@20: 0.1801	  valid NDCG: 0.1098	  valid precision: 0.05854	  valid hit: 0.6238	  valid mrr: 0.08548


batch:   1%|▏         | 1/71 [01:08<1:20:09, 68.70s/it]
batch:   3%|▎         | 2/71 [01:15<37:04, 32.24s/it]  
batch:   4%|▍         | 3/71 [01:22<23:19, 20.57s/it]
batch:   6%|▌         | 4/71 [01:28<16:51, 15.10s/it]
batch:   7%|▋         | 5/71 [01:35<13:15, 12.05s/it]
batch:   8%|▊         | 6/71 [01:42<11:04, 10.22s/it]
batch:  10%|▉         | 7/71 [01:48<09:40,  9.07s/it]
batch:  11%|█▏        | 8/71 [02:57<29:35, 28.19s/it]
batch:  13%|█▎        | 9/71 [03:04<22:12, 21.50s/it]
batch:  14%|█▍        | 10/71 [03:11<17:11, 16.91s/it]
batch:  15%|█▌        | 11/71 [03:17<13:43, 13.73s/it]
batch:  17%|█▋        | 12/71 [03:24<11:21, 11.55s/it]
batch:  18%|█▊        | 13/71 [03:31<09:42, 10.04s/it]
batch:  20%|█▉        | 14/71 [03:37<08:31,  8.97s/it]
batch:  21%|██        | 15/71 [04:45<24:58, 26.77s/it]
batch:  23%|██▎       | 16/71 [04:52<18:56, 20.67s/it]
batch:  24%|██▍       | 17/71 [04:58<14:47, 16.44s/it]
batch:  25%|██▌       | 18/71 [05:05<11:53, 13.46s/it]
batch:  27%|██▋       | 19/71 [05:11<09:52, 11.39s/it]
batch:  28%|██▊       | 20/71 [05:18<08:26,  9.93s/it]
batch:  30%|██▉       | 21/71 [05:24<07:25,  8.91s/it]
batch:  31%|███       | 22/71 [06:32<21:44, 26.62s/it]
batch:  32%|███▏      | 23/71 [06:39<16:27, 20.58s/it]
batch:  34%|███▍      | 24/71 [06:45<12:49, 16.38s/it]
batch:  35%|███▌      | 25/71 [06:52<10:18, 13.44s/it]
batch:  37%|███▋      | 26/71 [06:58<08:32, 11.38s/it]
batch:  38%|███▊      | 27/71 [07:05<07:17,  9.94s/it]
batch:  39%|███▉      | 28/71 [07:12<06:23,  8.92s/it]
batch:  41%|████      | 29/71 [08:20<18:38, 26.64s/it]
batch:  42%|████▏     | 30/71 [08:26<14:04, 20.60s/it]
batch:  44%|████▎     | 31/71 [08:33<10:55, 16.39s/it]
batch:  45%|████▌     | 32/71 [08:39<08:44, 13.45s/it]
batch:  46%|████▋     | 33/71 [08:46<07:12, 11.37s/it]
batch:  48%|████▊     | 34/71 [08:52<06:07,  9.93s/it]
batch:  49%|████▉     | 35/71 [08:59<05:20,  8.91s/it]
batch:  51%|█████     | 36/71 [10:07<15:32, 26.66s/it]
batch:  52%|█████▏    | 37/71 [10:13<11:41, 20.62s/it]
batch:  54%|█████▎    | 38/71 [10:20<09:02, 16.42s/it]
batch:  55%|█████▍    | 39/71 [10:27<07:11, 13.48s/it]
batch:  56%|█████▋    | 40/71 [10:33<05:54, 11.42s/it]
batch:  58%|█████▊    | 41/71 [10:40<04:59,  9.97s/it]
batch:  59%|█████▉    | 42/71 [10:46<04:19,  8.96s/it]
batch:  61%|██████    | 43/71 [11:55<12:29, 26.77s/it]
batch:  62%|██████▏   | 44/71 [12:01<09:18, 20.70s/it]
batch:  63%|██████▎   | 45/71 [12:08<07:08, 16.46s/it]
batch:  65%|██████▍   | 46/71 [12:14<05:37, 13.49s/it]
batch:  66%|██████▌   | 47/71 [12:21<04:34, 11.42s/it]
batch:  68%|██████▊   | 48/71 [12:28<03:49,  9.97s/it]
batch:  69%|██████▉   | 49/71 [12:34<03:16,  8.94s/it]
batch:  70%|███████   | 50/71 [13:42<09:21, 26.72s/it]
batch:  72%|███████▏  | 51/71 [13:49<06:53, 20.68s/it]
batch:  73%|███████▎  | 52/71 [13:56<05:12, 16.46s/it]
batch:  75%|███████▍  | 53/71 [14:02<04:02, 13.49s/it]
batch:  76%|███████▌  | 54/71 [14:09<03:14, 11.42s/it]
batch:  77%|███████▋  | 55/71 [14:15<02:39,  9.96s/it]
batch:  79%|███████▉  | 56/71 [14:22<02:15,  9.00s/it]
batch:  80%|████████  | 57/71 [15:31<06:17, 26.94s/it]
batch:  82%|████████▏ | 58/71 [15:37<04:30, 20.84s/it]
batch:  83%|████████▎ | 59/71 [15:44<03:19, 16.59s/it]
batch:  85%|████████▍ | 60/71 [15:51<02:29, 13.60s/it]
batch:  86%|████████▌ | 61/71 [15:57<01:54, 11.50s/it]
batch:  87%|████████▋ | 62/71 [16:04<01:30, 10.03s/it]
batch:  89%|████████▊ | 63/71 [16:10<01:11,  8.98s/it]
batch:  90%|█████████ | 64/71 [17:18<03:06, 26.67s/it]
batch:  92%|█████████▏| 65/71 [17:25<02:03, 20.63s/it]
batch:  93%|█████████▎| 66/71 [17:32<01:22, 16.41s/it]
batch:  94%|█████████▍| 67/71 [17:38<00:53, 13.45s/it]
batch:  96%|█████████▌| 68/71 [17:45<00:34, 11.40s/it]
batch:  97%|█████████▋| 69/71 [17:51<00:19,  9.95s/it]
batch:  99%|█████████▊| 70/71 [17:58<00:08,  8.95s/it]
batch: 100%|██████████| 71/71 [19:06<00:00, 26.66s/it]
epoch:  50%|█████     | 10/20 [2:19:16<2:30:16, 901.61s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 07: train loss: 9.708	  train recall@20: 0.2612	  train NDCG: 0.132	  train precision: 0.1113	  train hit: 0.5672	  train mrr: 0.1157
Top10:Epoch 07: valid loss: 9.319	  valid recall@20: 0.1488	  valid NDCG: 0.11	  valid precision: 0.1426	  valid hit: 0.5612	  valid mrr: 0.09489

Top20:Epoch 07: train loss: 9.708	  train recall@20: 0.3094	  train NDCG: 0.1437	  train precision: 0.06788	  train hit: 0.6496	  train mrr: 0.119
Top20:Epoch 07: valid loss: 9.319	  valid recall@20: 0.1851	  valid NDCG: 0.1211	  valid precision: 0.08971	  valid hit: 0.6344	  valid mrr: 0.09808

Top30:Epoch 07: train loss: 9.708	  train recall@20: 0.3425	  train NDCG: 0.1503	  train precision: 0.0511	  train hit: 0.6955	  train mrr: 0.1203
Top30:Epoch 07: valid loss: 9.319	  valid recall@20: 0.2111	  valid NDCG: 0.1276	  valid precision: 0.0683	  valid hit: 0.6735	  valid mrr: 0.09934


batch:   1%|▏         | 1/71 [01:08<1:19:20, 68.01s/it]
batch:   3%|▎         | 2/71 [01:14<36:36, 31.83s/it]  
batch:   4%|▍         | 3/71 [01:21<23:05, 20.37s/it]
batch:   6%|▌         | 4/71 [01:28<16:47, 15.04s/it]
batch:   7%|▋         | 5/71 [01:35<13:19, 12.12s/it]
batch:   8%|▊         | 6/71 [01:41<11:08, 10.29s/it]
batch:  10%|▉         | 7/71 [01:48<09:45,  9.14s/it]
batch:  11%|█▏        | 8/71 [02:56<29:16, 27.88s/it]
batch:  13%|█▎        | 9/71 [03:03<21:56, 21.23s/it]
batch:  14%|█▍        | 10/71 [03:09<16:59, 16.72s/it]
batch:  15%|█▌        | 11/71 [03:16<13:36, 13.61s/it]
batch:  17%|█▋        | 12/71 [03:22<11:16, 11.47s/it]
batch:  18%|█▊        | 13/71 [03:29<09:39,  9.99s/it]
batch:  20%|█▉        | 14/71 [03:36<08:30,  8.95s/it]
batch:  21%|██        | 15/71 [04:44<24:58, 26.76s/it]
batch:  23%|██▎       | 16/71 [04:50<18:56, 20.67s/it]
batch:  24%|██▍       | 17/71 [04:57<14:47, 16.43s/it]
batch:  25%|██▌       | 18/71 [05:03<11:53, 13.46s/it]
batch:  27%|██▋       | 19/71 [05:10<09:51, 11.38s/it]
batch:  28%|██▊       | 20/71 [05:16<08:26,  9.93s/it]
batch:  30%|██▉       | 21/71 [05:23<07:25,  8.92s/it]
batch:  31%|███       | 22/71 [06:31<21:47, 26.68s/it]
batch:  32%|███▏      | 23/71 [06:38<16:30, 20.63s/it]
batch:  34%|███▍      | 24/71 [06:44<12:52, 16.43s/it]
batch:  35%|███▌      | 25/71 [06:51<10:19, 13.47s/it]
batch:  37%|███▋      | 26/71 [06:57<08:33, 11.42s/it]
batch:  38%|███▊      | 27/71 [07:04<07:19,  9.99s/it]
batch:  39%|███▉      | 28/71 [07:11<06:26,  8.99s/it]
batch:  41%|████      | 29/71 [08:22<19:17, 27.56s/it]
batch:  42%|████▏     | 30/71 [08:28<14:32, 21.28s/it]
batch:  44%|████▎     | 31/71 [08:35<11:14, 16.86s/it]
batch:  45%|████▌     | 32/71 [08:41<08:57, 13.77s/it]
batch:  46%|████▋     | 33/71 [08:48<07:21, 11.62s/it]
batch:  48%|████▊     | 34/71 [08:54<06:13, 10.10s/it]
batch:  49%|████▉     | 35/71 [09:01<05:24,  9.02s/it]
batch:  51%|█████     | 36/71 [10:09<15:36, 26.75s/it]
batch:  52%|█████▏    | 37/71 [10:16<11:43, 20.68s/it]
batch:  54%|█████▎    | 38/71 [10:22<09:02, 16.43s/it]
batch:  55%|█████▍    | 39/71 [10:29<07:10, 13.45s/it]
batch:  56%|█████▋    | 40/71 [10:35<05:52, 11.37s/it]
batch:  58%|█████▊    | 41/71 [10:42<04:57,  9.91s/it]
batch:  59%|█████▉    | 42/71 [10:48<04:18,  8.90s/it]
batch:  61%|██████    | 43/71 [11:56<12:25, 26.64s/it]
batch:  62%|██████▏   | 44/71 [12:03<09:16, 20.60s/it]
batch:  63%|██████▎   | 45/71 [12:09<07:05, 16.37s/it]
batch:  65%|██████▍   | 46/71 [12:16<05:35, 13.41s/it]
batch:  66%|██████▌   | 47/71 [12:22<04:32, 11.34s/it]
batch:  68%|██████▊   | 48/71 [12:29<03:47,  9.90s/it]
batch:  69%|██████▉   | 49/71 [12:35<03:15,  8.87s/it]
batch:  70%|███████   | 50/71 [13:43<09:18, 26.59s/it]
batch:  72%|███████▏  | 51/71 [13:50<06:51, 20.56s/it]
batch:  73%|███████▎  | 52/71 [13:56<05:10, 16.36s/it]
batch:  75%|███████▍  | 53/71 [14:03<04:01, 13.42s/it]
batch:  76%|███████▌  | 54/71 [14:09<03:12, 11.35s/it]
batch:  77%|███████▋  | 55/71 [14:16<02:38,  9.89s/it]
batch:  79%|███████▉  | 56/71 [14:22<02:13,  8.87s/it]
batch:  80%|████████  | 57/71 [15:30<06:13, 26.66s/it]
batch:  82%|████████▏ | 58/71 [15:37<04:28, 20.62s/it]
batch:  83%|████████▎ | 59/71 [15:43<03:16, 16.39s/it]
batch:  85%|████████▍ | 60/71 [15:50<02:27, 13.43s/it]
batch:  86%|████████▌ | 61/71 [15:57<01:53, 11.36s/it]
batch:  87%|████████▋ | 62/71 [16:03<01:29,  9.92s/it]
batch:  89%|████████▊ | 63/71 [16:10<01:11,  8.90s/it]
batch:  90%|█████████ | 64/71 [17:18<03:06, 26.67s/it]
batch:  92%|█████████▏| 65/71 [17:24<02:03, 20.63s/it]
batch:  93%|█████████▎| 66/71 [17:31<01:21, 16.39s/it]
batch:  94%|█████████▍| 67/71 [17:37<00:53, 13.43s/it]
batch:  96%|█████████▌| 68/71 [17:44<00:34, 11.35s/it]
batch:  97%|█████████▋| 69/71 [17:50<00:19,  9.89s/it]
batch:  99%|█████████▊| 70/71 [17:57<00:08,  8.88s/it]
Top10:Epoch 08: train loss: 9.613	  train recall@20: 0.2908	  train NDCG: 0.1485	  train precision: 0.1256	  train hit: 0.6197	  train mrr: 0.1296
Top10:Epoch 08: valid loss: 9.2	  valid recall@20: 0.1731	  valid NDCG: 0.1266	  valid precision: 0.1647	  valid hit: 0.6062	  valid mrr: 0.1089

Top20:Epoch 08: train loss: 9.613	  train recall@20: 0.3409	  train NDCG: 0.1611	  train precision: 0.07616	  train hit: 0.6946	  train mrr: 0.1332
Top20:Epoch 08: valid loss: 9.2	  valid recall@20: 0.2114	  valid NDCG: 0.1383	  valid precision: 0.1015	  valid hit: 0.6738	  valid mrr: 0.1122

Top30:Epoch 08: train loss: 9.613	  train recall@20: 0.3749	  train NDCG: 0.1681	  train precision: 0.05689	  train hit: 0.7382	  train mrr: 0.1346
Top30:Epoch 08: valid loss: 9.2	  valid recall@20: 0.2366	  valid NDCG: 0.145	  valid precision: 0.0766	  valid hit: 0.7032	  valid mrr: 0.1135

batch: 100%|██████████| 71/71 [19:05<00:00, 26.63s/it]
epoch:  60%|██████    | 12/20 [2:38:22<1:41:49, 763.69s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]
batch:   1%|▏         | 1/71 [01:07<1:19:18, 67.97s/it]
batch:   3%|▎         | 2/71 [01:14<36:35, 31.81s/it]  
batch:   4%|▍         | 3/71 [01:20<22:57, 20.26s/it]
batch:   6%|▌         | 4/71 [01:27<16:33, 14.83s/it]
batch:   7%|▋         | 5/71 [01:34<13:01, 11.84s/it]
batch:   8%|▊         | 6/71 [01:40<10:52, 10.03s/it]
batch:  10%|▉         | 7/71 [01:47<09:28,  8.88s/it]
batch:  11%|█▏        | 8/71 [02:55<29:06, 27.72s/it]
batch:  13%|█▎        | 9/71 [03:01<21:48, 21.10s/it]
batch:  14%|█▍        | 10/71 [03:08<16:51, 16.59s/it]
batch:  15%|█▌        | 11/71 [03:14<13:30, 13.50s/it]
batch:  17%|█▋        | 12/71 [03:21<11:11, 11.37s/it]
batch:  18%|█▊        | 13/71 [03:27<09:34,  9.91s/it]
batch:  20%|█▉        | 14/71 [03:34<08:26,  8.88s/it]
batch:  21%|██        | 15/71 [04:42<24:54, 26.68s/it]
batch:  23%|██▎       | 16/71 [04:48<18:53, 20.61s/it]
batch:  24%|██▍       | 17/71 [04:55<14:45, 16.39s/it]
batch:  25%|██▌       | 18/71 [05:01<11:52, 13.44s/it]
batch:  27%|██▋       | 19/71 [05:08<09:51, 11.37s/it]
batch:  28%|██▊       | 20/71 [05:14<08:26,  9.92s/it]
batch:  30%|██▉       | 21/71 [05:21<07:26,  8.92s/it]
batch:  31%|███       | 22/71 [06:29<21:48, 26.70s/it]
batch:  32%|███▏      | 23/71 [06:36<16:31, 20.66s/it]
batch:  34%|███▍      | 24/71 [06:42<12:52, 16.44s/it]
batch:  35%|███▌      | 25/71 [06:49<10:21, 13.52s/it]
batch:  37%|███▋      | 26/71 [06:56<08:34, 11.44s/it]
batch:  38%|███▊      | 27/71 [07:02<07:19,  9.98s/it]
batch:  39%|███▉      | 28/71 [07:09<06:26,  8.98s/it]
batch:  41%|████      | 29/71 [08:17<18:43, 26.75s/it]
batch:  42%|████▏     | 30/71 [08:24<14:08, 20.69s/it]
batch:  44%|████▎     | 31/71 [08:30<10:58, 16.46s/it]
batch:  45%|████▌     | 32/71 [08:37<08:46, 13.49s/it]
batch:  46%|████▋     | 33/71 [08:43<07:15, 11.45s/it]
batch:  48%|████▊     | 34/71 [08:50<06:09,  9.99s/it]
batch:  49%|████▉     | 35/71 [08:57<05:22,  8.97s/it]
batch:  51%|█████     | 36/71 [10:05<15:32, 26.65s/it]
batch:  52%|█████▏    | 37/71 [10:11<11:40, 20.61s/it]
batch:  54%|█████▎    | 38/71 [10:18<09:01, 16.40s/it]
batch:  55%|█████▍    | 39/71 [10:24<07:10, 13.44s/it]
batch:  56%|█████▋    | 40/71 [10:31<05:52, 11.37s/it]
batch:  58%|█████▊    | 41/71 [10:37<04:57,  9.92s/it]
batch:  59%|█████▉    | 42/71 [10:44<04:17,  8.89s/it]
batch:  61%|██████    | 43/71 [11:52<12:26, 26.66s/it]
batch:  62%|██████▏   | 44/71 [11:58<09:16, 20.62s/it]
batch:  63%|██████▎   | 45/71 [12:05<07:06, 16.40s/it]
batch:  65%|██████▍   | 46/71 [12:11<05:36, 13.45s/it]
batch:  66%|██████▌   | 47/71 [12:18<04:33, 11.38s/it]
batch:  68%|██████▊   | 48/71 [12:25<03:48,  9.93s/it]
batch:  69%|██████▉   | 49/71 [12:31<03:16,  8.91s/it]
batch:  70%|███████   | 50/71 [13:39<09:18, 26.61s/it]
batch:  72%|███████▏  | 51/71 [13:46<06:51, 20.58s/it]
batch:  73%|███████▎  | 52/71 [13:52<05:11, 16.40s/it]
batch:  75%|███████▍  | 53/71 [13:59<04:02, 13.45s/it]
batch:  76%|███████▌  | 54/71 [14:05<03:13, 11.38s/it]
batch:  77%|███████▋  | 55/71 [14:12<02:38,  9.92s/it]
batch:  79%|███████▉  | 56/71 [14:18<02:13,  8.90s/it]
batch:  80%|████████  | 57/71 [15:26<06:12, 26.60s/it]
batch:  82%|████████▏ | 58/71 [15:33<04:27, 20.59s/it]
batch:  83%|████████▎ | 59/71 [15:39<03:16, 16.38s/it]
batch:  85%|████████▍ | 60/71 [15:46<02:27, 13.45s/it]
batch:  86%|████████▌ | 61/71 [15:53<01:53, 11.39s/it]
batch:  87%|████████▋ | 62/71 [15:59<01:29,  9.94s/it]
batch:  89%|████████▊ | 63/71 [16:06<01:11,  8.91s/it]
batch:  90%|█████████ | 64/71 [17:13<03:06, 26.60s/it]
batch:  92%|█████████▏| 65/71 [17:20<02:03, 20.57s/it]
batch:  93%|█████████▎| 66/71 [17:27<01:23, 16.63s/it]
batch:  94%|█████████▍| 67/71 [17:35<00:55, 13.85s/it]
batch:  96%|█████████▌| 68/71 [17:42<00:35, 11.89s/it]
batch:  97%|█████████▋| 69/71 [17:49<00:21, 10.51s/it]
batch:  99%|█████████▊| 70/71 [17:57<00:09,  9.52s/it]
batch: 100%|██████████| 71/71 [19:10<00:00, 28.77s/it]
epoch:  65%|██████▌   | 13/20 [2:57:32<1:39:30, 852.90s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 09: train loss: 9.523	  train recall@20: 0.3211	  train NDCG: 0.1682	  train precision: 0.1411	  train hit: 0.6646	  train mrr: 0.1472
Top10:Epoch 09: valid loss: 9.088	  valid recall@20: 0.1998	  valid NDCG: 0.1488	  valid precision: 0.1905	  valid hit: 0.6485	  valid mrr: 0.1296

Top20:Epoch 09: train loss: 9.523	  train recall@20: 0.3755	  train NDCG: 0.1819	  train precision: 0.08512	  train hit: 0.7356	  train mrr: 0.1511
Top20:Epoch 09: valid loss: 9.088	  valid recall@20: 0.2405	  valid NDCG: 0.1621	  valid precision: 0.1164	  valid hit: 0.7074	  valid mrr: 0.1334

Top30:Epoch 09: train loss: 9.523	  train recall@20: 0.4097	  train NDCG: 0.1893	  train precision: 0.06326	  train hit: 0.7731	  train mrr: 0.1526
Top30:Epoch 09: valid loss: 9.088	  valid recall@20: 0.27	  valid NDCG: 0.1694	  valid precision: 0.08729	  valid hit: 0.7332	  valid mrr: 0.1348


batch:   1%|▏         | 1/71 [01:12<1:24:26, 72.38s/it]
batch:   3%|▎         | 2/71 [01:19<39:00, 33.92s/it]  
batch:   4%|▍         | 3/71 [01:26<24:31, 21.64s/it]
batch:   6%|▌         | 4/71 [01:33<17:42, 15.87s/it]
batch:   7%|▋         | 5/71 [01:40<13:56, 12.67s/it]
batch:   8%|▊         | 6/71 [01:47<11:38, 10.75s/it]
batch:  10%|▉         | 7/71 [01:54<10:09,  9.53s/it]
batch:  11%|█▏        | 8/71 [03:07<31:20, 29.85s/it]
batch:  13%|█▎        | 9/71 [03:14<23:31, 22.76s/it]
batch:  14%|█▍        | 10/71 [03:22<18:15, 17.96s/it]
batch:  15%|█▌        | 11/71 [03:29<14:40, 14.67s/it]
batch:  17%|█▋        | 12/71 [03:36<12:11, 12.40s/it]
batch:  18%|█▊        | 13/71 [03:43<10:27, 10.83s/it]
batch:  20%|█▉        | 14/71 [03:51<09:14,  9.72s/it]
batch:  21%|██        | 15/71 [05:05<27:13, 29.16s/it]
batch:  23%|██▎       | 16/71 [05:12<20:39, 22.53s/it]
batch:  24%|██▍       | 17/71 [05:19<16:08, 17.93s/it]
batch:  25%|██▌       | 18/71 [05:26<12:59, 14.70s/it]
batch:  27%|██▋       | 19/71 [05:33<10:47, 12.45s/it]
batch:  28%|██▊       | 20/71 [05:41<09:14, 10.87s/it]
batch:  30%|██▉       | 21/71 [05:48<08:08,  9.77s/it]
batch:  31%|███       | 22/71 [07:01<23:28, 28.75s/it]
batch:  32%|███▏      | 23/71 [07:08<17:45, 22.20s/it]
batch:  34%|███▍      | 24/71 [07:15<13:49, 17.64s/it]
batch:  35%|███▌      | 25/71 [07:22<11:04, 14.45s/it]
batch:  37%|███▋      | 26/71 [07:29<09:10, 12.23s/it]
batch:  38%|███▊      | 27/71 [07:36<07:49, 10.67s/it]
batch:  39%|███▉      | 28/71 [07:43<06:51,  9.57s/it]
batch:  41%|████      | 29/71 [08:56<19:59, 28.56s/it]
batch:  42%|████▏     | 30/71 [09:03<15:07, 22.14s/it]
batch:  44%|████▎     | 31/71 [09:10<11:46, 17.65s/it]
batch:  45%|████▌     | 32/71 [09:17<09:26, 14.52s/it]
batch:  46%|████▋     | 33/71 [09:24<07:47, 12.31s/it]
batch:  48%|████▊     | 34/71 [09:32<06:38, 10.77s/it]
batch:  49%|████▉     | 35/71 [09:39<05:49,  9.70s/it]
batch:  51%|█████     | 36/71 [10:53<16:53, 28.97s/it]
batch:  52%|█████▏    | 37/71 [11:00<12:42, 22.42s/it]
batch:  54%|█████▎    | 38/71 [11:07<09:48, 17.84s/it]
batch:  55%|█████▍    | 39/71 [11:14<07:48, 14.64s/it]
batch:  56%|█████▋    | 40/71 [11:21<06:24, 12.40s/it]
batch:  58%|█████▊    | 41/71 [11:29<05:24, 10.83s/it]
batch:  59%|█████▉    | 42/71 [11:36<04:42,  9.75s/it]
batch:  61%|██████    | 43/71 [12:50<13:32, 29.01s/it]
batch:  62%|██████▏   | 44/71 [12:57<10:06, 22.46s/it]
batch:  63%|██████▎   | 45/71 [13:04<07:43, 17.83s/it]
batch:  65%|██████▍   | 46/71 [13:11<06:04, 14.58s/it]
batch:  66%|██████▌   | 47/71 [13:18<04:55, 12.30s/it]
batch:  68%|██████▊   | 48/71 [13:25<04:05, 10.69s/it]
batch:  69%|██████▉   | 49/71 [13:32<03:30,  9.57s/it]
batch:  70%|███████   | 50/71 [14:45<09:58, 28.52s/it]
batch:  72%|███████▏  | 51/71 [14:52<07:21, 22.06s/it]
batch:  73%|███████▎  | 52/71 [14:59<05:33, 17.56s/it]
batch:  75%|███████▍  | 53/71 [15:06<04:19, 14.41s/it]
batch:  76%|███████▌  | 54/71 [15:13<03:27, 12.20s/it]
batch:  77%|███████▋  | 55/71 [15:20<02:51, 10.70s/it]
batch:  79%|███████▉  | 56/71 [15:27<02:24,  9.64s/it]
batch:  80%|████████  | 57/71 [16:42<06:47, 29.10s/it]
batch:  82%|████████▏ | 58/71 [16:49<04:52, 22.53s/it]
batch:  83%|████████▎ | 59/71 [16:56<03:35, 17.96s/it]
batch:  85%|████████▍ | 60/71 [17:03<02:42, 14.73s/it]
batch:  86%|████████▌ | 61/71 [17:10<02:04, 12.46s/it]
batch:  87%|████████▋ | 62/71 [17:18<01:37, 10.88s/it]
batch:  89%|████████▊ | 63/71 [17:25<01:18,  9.78s/it]
batch:  90%|█████████ | 64/71 [18:40<03:24, 29.25s/it]
batch:  92%|█████████▏| 65/71 [18:47<02:15, 22.61s/it]
batch:  93%|█████████▎| 66/71 [18:54<01:29, 17.99s/it]
batch:  94%|█████████▍| 67/71 [19:01<00:59, 14.76s/it]
batch:  96%|█████████▌| 68/71 [19:08<00:37, 12.48s/it]
batch:  97%|█████████▋| 69/71 [19:15<00:21, 10.90s/it]
batch:  99%|█████████▊| 70/71 [19:23<00:09,  9.78s/it]
batch: 100%|██████████| 71/71 [20:35<00:00, 28.62s/it]
epoch:  70%|███████   | 14/20 [3:18:08<1:34:46, 947.71s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 10: train loss: 9.434	  train recall@20: 0.3495	  train NDCG: 0.188	  train precision: 0.1574	  train hit: 0.7046	  train mrr: 0.1645
Top10:Epoch 10: valid loss: 9.029	  valid recall@20: 0.2215	  valid NDCG: 0.1675	  valid precision: 0.2114	  valid hit: 0.6765	  valid mrr: 0.1466

Top20:Epoch 10: train loss: 9.434	  train recall@20: 0.4039	  train NDCG: 0.2021	  train precision: 0.09369	  train hit: 0.7677	  train mrr: 0.1686
Top20:Epoch 10: valid loss: 9.029	  valid recall@20: 0.2668	  valid NDCG: 0.1818	  valid precision: 0.1289	  valid hit: 0.7226	  valid mrr: 0.1507

Top30:Epoch 10: train loss: 9.434	  train recall@20: 0.4414	  train NDCG: 0.21	  train precision: 0.06939	  train hit: 0.8041	  train mrr: 0.1702
Top30:Epoch 10: valid loss: 9.029	  valid recall@20: 0.2969	  valid NDCG: 0.1895	  valid precision: 0.09641	  valid hit: 0.7456	  valid mrr: 0.1522


batch:   1%|▏         | 1/71 [01:12<1:24:53, 72.76s/it]
batch:   3%|▎         | 2/71 [01:19<39:17, 34.17s/it]  
batch:   4%|▍         | 3/71 [01:27<24:46, 21.86s/it]
batch:   6%|▌         | 4/71 [01:34<17:56, 16.07s/it]
batch:   7%|▋         | 5/71 [01:41<14:08, 12.86s/it]
batch:   8%|▊         | 6/71 [01:48<11:49, 10.92s/it]
batch:  10%|▉         | 7/71 [01:55<10:20,  9.69s/it]
batch:  11%|█▏        | 8/71 [03:09<31:43, 30.21s/it]
batch:  13%|█▎        | 9/71 [03:17<23:45, 22.99s/it]
batch:  14%|█▍        | 10/71 [03:24<18:24, 18.11s/it]
batch:  15%|█▌        | 11/71 [03:31<14:45, 14.76s/it]
batch:  17%|█▋        | 12/71 [03:38<12:14, 12.45s/it]
batch:  18%|█▊        | 13/71 [03:45<10:30, 10.87s/it]
batch:  20%|█▉        | 14/71 [03:52<09:15,  9.74s/it]
batch:  21%|██        | 15/71 [05:07<27:13, 29.17s/it]
batch:  23%|██▎       | 16/71 [05:14<20:37, 22.50s/it]
batch:  24%|██▍       | 17/71 [05:21<16:02, 17.83s/it]
batch:  25%|██▌       | 18/71 [05:28<12:51, 14.55s/it]
batch:  27%|██▋       | 19/71 [05:34<10:37, 12.26s/it]
batch:  28%|██▊       | 20/71 [05:41<09:04, 10.67s/it]
batch:  30%|██▉       | 21/71 [05:48<07:58,  9.57s/it]
batch:  31%|███       | 22/71 [07:01<23:16, 28.50s/it]
batch:  32%|███▏      | 23/71 [07:08<17:37, 22.04s/it]
batch:  34%|███▍      | 24/71 [07:15<13:44, 17.55s/it]
batch:  35%|███▌      | 25/71 [07:22<11:02, 14.39s/it]
batch:  37%|███▋      | 26/71 [07:29<09:09, 12.22s/it]
batch:  38%|███▊      | 27/71 [07:36<07:50, 10.70s/it]
batch:  39%|███▉      | 28/71 [07:44<06:54,  9.65s/it]
batch:  41%|████      | 29/71 [08:58<20:16, 28.97s/it]
batch:  42%|████▏     | 30/71 [09:05<15:18, 22.41s/it]
batch:  44%|████▎     | 31/71 [09:12<11:54, 17.85s/it]
batch:  45%|████▌     | 32/71 [09:19<09:31, 14.66s/it]
batch:  46%|████▋     | 33/71 [09:26<07:51, 12.41s/it]
batch:  48%|████▊     | 34/71 [09:34<06:41, 10.84s/it]
batch:  49%|████▉     | 35/71 [09:41<05:50,  9.74s/it]
batch:  51%|█████     | 36/71 [10:55<16:54, 28.99s/it]
batch:  52%|█████▏    | 37/71 [11:02<12:42, 22.42s/it]
batch:  54%|█████▎    | 38/71 [11:09<09:49, 17.86s/it]
batch:  55%|█████▍    | 39/71 [11:16<07:48, 14.64s/it]
batch:  56%|█████▋    | 40/71 [11:23<06:24, 12.40s/it]
batch:  58%|█████▊    | 41/71 [11:30<05:25, 10.84s/it]
batch:  59%|█████▉    | 42/71 [11:38<04:42,  9.75s/it]
batch:  61%|██████    | 43/71 [12:50<13:17, 28.49s/it]
batch:  62%|██████▏   | 44/71 [12:57<09:55, 22.06s/it]
batch:  63%|██████▎   | 45/71 [13:04<07:36, 17.55s/it]
batch:  65%|██████▍   | 46/71 [13:11<05:59, 14.40s/it]
batch:  66%|██████▌   | 47/71 [13:18<04:52, 12.20s/it]
batch:  68%|██████▊   | 48/71 [13:25<04:04, 10.64s/it]
batch:  69%|██████▉   | 49/71 [13:32<03:30,  9.56s/it]
batch:  70%|███████   | 50/71 [14:46<10:03, 28.76s/it]
batch:  72%|███████▏  | 51/71 [14:53<07:25, 22.27s/it]
batch:  73%|███████▎  | 52/71 [15:00<05:37, 17.77s/it]
batch:  75%|███████▍  | 53/71 [15:07<04:22, 14.61s/it]
batch:  76%|███████▌  | 54/71 [15:15<03:30, 12.40s/it]
batch:  77%|███████▋  | 55/71 [15:22<02:53, 10.86s/it]
batch:  79%|███████▉  | 56/71 [15:29<02:25,  9.73s/it]
batch:  80%|████████  | 57/71 [16:40<06:35, 28.27s/it]
batch:  82%|████████▏ | 58/71 [16:47<04:44, 21.91s/it]
batch:  83%|████████▎ | 59/71 [16:54<03:29, 17.43s/it]
batch:  85%|████████▍ | 60/71 [17:01<02:37, 14.29s/it]
batch:  86%|████████▌ | 61/71 [17:08<01:59, 11.98s/it]
batch:  87%|████████▋ | 62/71 [17:15<01:33, 10.36s/it]
batch:  89%|████████▊ | 63/71 [17:21<01:13,  9.22s/it]
batch:  90%|█████████ | 64/71 [18:29<03:08, 26.89s/it]
batch:  92%|█████████▏| 65/71 [18:36<02:04, 20.77s/it]
batch:  93%|█████████▎| 66/71 [18:42<01:22, 16.51s/it]
batch:  94%|█████████▍| 67/71 [18:49<00:54, 13.57s/it]
batch:  96%|█████████▌| 68/71 [18:56<00:34, 11.63s/it]
batch:  97%|█████████▋| 69/71 [19:03<00:20, 10.26s/it]
batch:  99%|█████████▊| 70/71 [19:10<00:09,  9.22s/it]
batch: 100%|██████████| 71/71 [20:21<00:00, 27.61s/it]
epoch:  75%|███████▌  | 15/20 [3:38:29<1:24:55, 1019.15s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 11: train loss: 9.36	  train recall@20: 0.3717	  train NDCG: 0.2037	  train precision: 0.1701	  train hit: 0.7297	  train mrr: 0.1788
Top10:Epoch 11: valid loss: 8.993	  valid recall@20: 0.2421	  valid NDCG: 0.1841	  valid precision: 0.2326	  valid hit: 0.6979	  valid mrr: 0.1613

Top20:Epoch 11: train loss: 9.36	  train recall@20: 0.4318	  train NDCG: 0.22	  train precision: 0.1019	  train hit: 0.7944	  train mrr: 0.1835
Top20:Epoch 11: valid loss: 8.993	  valid recall@20: 0.2896	  valid NDCG: 0.1988	  valid precision: 0.1398	  valid hit: 0.7379	  valid mrr: 0.1656

Top30:Epoch 11: train loss: 9.36	  train recall@20: 0.4707	  train NDCG: 0.2284	  train precision: 0.07523	  train hit: 0.8276	  train mrr: 0.1851
Top30:Epoch 11: valid loss: 8.993	  valid recall@20: 0.3215	  valid NDCG: 0.2071	  valid precision: 0.1042	  valid hit: 0.7568	  valid mrr: 0.1672


batch:   1%|▏         | 1/71 [01:11<1:23:20, 71.44s/it]
batch:   3%|▎         | 2/71 [01:18<38:20, 33.34s/it]  
batch:   4%|▍         | 3/71 [01:24<23:56, 21.13s/it]
batch:   6%|▌         | 4/71 [01:31<17:15, 15.45s/it]
batch:   7%|▋         | 5/71 [01:38<13:35, 12.35s/it]
batch:   8%|▊         | 6/71 [01:45<11:20, 10.46s/it]
batch:  10%|▉         | 7/71 [01:51<09:50,  9.22s/it]
batch:  11%|█▏        | 8/71 [03:00<29:40, 28.27s/it]
batch:  13%|█▎        | 9/71 [03:07<22:12, 21.49s/it]
batch:  14%|█▍        | 10/71 [03:14<17:10, 16.90s/it]
batch:  15%|█▌        | 11/71 [03:20<13:46, 13.77s/it]
batch:  17%|█▋        | 12/71 [03:27<11:30, 11.71s/it]
batch:  18%|█▊        | 13/71 [03:34<09:56, 10.29s/it]
batch:  20%|█▉        | 14/71 [03:41<08:45,  9.22s/it]
batch:  21%|██        | 15/71 [04:50<25:21, 27.17s/it]
batch:  23%|██▎       | 16/71 [04:56<19:12, 20.96s/it]
batch:  24%|██▍       | 17/71 [05:03<15:00, 16.68s/it]
batch:  25%|██▌       | 18/71 [05:10<12:05, 13.68s/it]
batch:  27%|██▋       | 19/71 [05:16<10:03, 11.60s/it]
batch:  28%|██▊       | 20/71 [05:23<08:35, 10.10s/it]
batch:  30%|██▉       | 21/71 [05:30<07:41,  9.23s/it]
batch:  31%|███       | 22/71 [06:41<22:38, 27.72s/it]
batch:  32%|███▏      | 23/71 [06:48<17:09, 21.45s/it]
batch:  34%|███▍      | 24/71 [06:55<13:24, 17.11s/it]
batch:  35%|███▌      | 25/71 [07:02<10:46, 14.05s/it]
batch:  37%|███▋      | 26/71 [07:09<08:56, 11.93s/it]
batch:  38%|███▊      | 27/71 [07:16<07:39, 10.45s/it]
batch:  39%|███▉      | 28/71 [07:23<06:42,  9.36s/it]
batch:  41%|████      | 29/71 [08:34<19:36, 28.01s/it]
batch:  42%|████▏     | 30/71 [08:41<14:50, 21.73s/it]
batch:  44%|████▎     | 31/71 [08:48<11:31, 17.29s/it]
batch:  45%|████▌     | 32/71 [08:55<09:13, 14.18s/it]
batch:  46%|████▋     | 33/71 [09:02<07:36, 12.01s/it]
batch:  48%|████▊     | 34/71 [09:09<06:28, 10.50s/it]
batch:  49%|████▉     | 35/71 [09:16<05:38,  9.41s/it]
batch:  51%|█████     | 36/71 [10:26<16:09, 27.69s/it]
batch:  52%|█████▏    | 37/71 [10:33<12:08, 21.42s/it]
batch:  54%|█████▎    | 38/71 [10:40<09:21, 17.01s/it]
batch:  55%|█████▍    | 39/71 [10:46<07:24, 13.89s/it]
batch:  56%|█████▋    | 40/71 [10:53<06:02, 11.70s/it]
batch:  58%|█████▊    | 41/71 [10:59<05:04, 10.15s/it]
batch:  59%|█████▉    | 42/71 [11:06<04:22,  9.07s/it]
batch:  61%|██████    | 43/71 [12:16<12:43, 27.27s/it]
batch:  62%|██████▏   | 44/71 [12:22<09:30, 21.12s/it]
batch:  63%|██████▎   | 45/71 [12:29<07:16, 16.79s/it]
batch:  65%|██████▍   | 46/71 [12:36<05:44, 13.77s/it]
batch:  66%|██████▌   | 47/71 [12:43<04:40, 11.67s/it]
batch:  68%|██████▊   | 48/71 [12:49<03:54, 10.21s/it]
batch:  69%|██████▉   | 49/71 [12:56<03:21,  9.18s/it]
batch:  70%|███████   | 50/71 [14:06<09:37, 27.49s/it]
batch:  72%|███████▏  | 51/71 [14:13<07:05, 21.28s/it]
batch:  73%|███████▎  | 52/71 [14:20<05:22, 16.96s/it]
batch:  75%|███████▍  | 53/71 [14:27<04:11, 13.96s/it]
batch:  76%|███████▌  | 54/71 [14:34<03:20, 11.78s/it]
batch:  77%|███████▋  | 55/71 [14:41<02:44, 10.28s/it]
batch:  79%|███████▉  | 56/71 [14:47<02:18,  9.25s/it]
batch:  80%|████████  | 57/71 [15:59<06:31, 27.93s/it]
batch:  82%|████████▏ | 58/71 [16:06<04:41, 21.63s/it]
batch:  83%|████████▎ | 59/71 [16:13<03:26, 17.19s/it]
batch:  85%|████████▍ | 60/71 [16:19<02:34, 14.05s/it]
batch:  86%|████████▌ | 61/71 [16:26<01:58, 11.86s/it]
batch:  87%|████████▋ | 62/71 [16:33<01:33, 10.35s/it]
batch:  89%|████████▊ | 63/71 [16:40<01:14,  9.28s/it]
batch:  90%|█████████ | 64/71 [17:53<03:19, 28.48s/it]
batch:  92%|█████████▏| 65/71 [18:00<02:11, 21.96s/it]
batch:  93%|█████████▎| 66/71 [18:07<01:27, 17.53s/it]
batch:  94%|█████████▍| 67/71 [18:14<00:57, 14.43s/it]
batch:  96%|█████████▌| 68/71 [18:21<00:36, 12.14s/it]
batch:  97%|█████████▋| 69/71 [18:28<00:20, 10.49s/it]
batch:  99%|█████████▊| 70/71 [18:34<00:09,  9.33s/it]
Top10:Epoch 12: train loss: 9.282	  train recall@20: 0.3916	  train NDCG: 0.2193	  train precision: 0.1825	  train hit: 0.751	  train mrr: 0.1924
Top10:Epoch 12: valid loss: 9.004	  valid recall@20: 0.2633	  valid NDCG: 0.201	  valid precision: 0.2536	  valid hit: 0.7153	  valid mrr: 0.1763

Top20:Epoch 12: train loss: 9.282	  train recall@20: 0.4521	  train NDCG: 0.2361	  train precision: 0.1089	  train hit: 0.8075	  train mrr: 0.1972
Top20:Epoch 12: valid loss: 9.004	  valid recall@20: 0.3121	  valid NDCG: 0.2165	  valid precision: 0.1518	  valid hit: 0.7447	  valid mrr: 0.1808

Top30:Epoch 12: train loss: 9.282	  train recall@20: 0.4901	  train NDCG: 0.2447	  train precision: 0.08027	  train hit: 0.8372	  train mrr: 0.1989
Top30:Epoch 12: valid loss: 9.004	  valid recall@20: 0.3434	  valid NDCG: 0.2247	  valid precision: 0.1122	  valid hit: 0.7615	  valid mrr: 0.1824

batch: 100%|██████████| 71/71 [19:42<00:00, 26.92s/it]
epoch:  85%|████████▌ | 17/20 [3:58:12<41:48, 836.27s/it]   
batch:   0%|          | 0/71 [00:00<?, ?it/s]
batch:   1%|▏         | 1/71 [01:10<1:22:07, 70.39s/it]
batch:   3%|▎         | 2/71 [01:17<38:16, 33.29s/it]  
batch:   4%|▍         | 3/71 [01:24<24:07, 21.28s/it]
batch:   6%|▌         | 4/71 [01:31<17:23, 15.58s/it]
batch:   7%|▋         | 5/71 [01:38<13:55, 12.65s/it]
batch:   8%|▊         | 6/71 [01:46<11:41, 10.79s/it]
batch:  10%|▉         | 7/71 [01:53<10:08,  9.51s/it]
batch:  11%|█▏        | 8/71 [03:04<30:44, 29.28s/it]
batch:  13%|█▎        | 9/71 [03:11<23:01, 22.28s/it]
batch:  14%|█▍        | 10/71 [03:18<17:52, 17.58s/it]
batch:  15%|█▌        | 11/71 [03:25<14:19, 14.32s/it]
batch:  17%|█▋        | 12/71 [03:32<11:51, 12.06s/it]
batch:  18%|█▊        | 13/71 [03:39<10:06, 10.46s/it]
batch:  20%|█▉        | 14/71 [03:46<08:54,  9.38s/it]
batch:  21%|██        | 15/71 [04:57<26:09, 28.02s/it]
batch:  23%|██▎       | 16/71 [05:04<19:57, 21.78s/it]
batch:  24%|██▍       | 17/71 [05:11<15:35, 17.33s/it]
batch:  25%|██▌       | 18/71 [05:18<12:31, 14.19s/it]
batch:  27%|██▋       | 19/71 [05:25<10:19, 11.92s/it]
batch:  28%|██▊       | 20/71 [05:31<08:50, 10.40s/it]
batch:  30%|██▉       | 21/71 [05:38<07:47,  9.34s/it]
batch:  31%|███       | 22/71 [06:52<23:24, 28.67s/it]
batch:  32%|███▏      | 23/71 [06:59<17:47, 22.23s/it]
batch:  34%|███▍      | 24/71 [07:06<13:49, 17.65s/it]
batch:  35%|███▌      | 25/71 [07:13<11:04, 14.44s/it]
batch:  37%|███▋      | 26/71 [07:20<09:05, 12.13s/it]
batch:  38%|███▊      | 27/71 [07:27<07:41, 10.48s/it]
batch:  39%|███▉      | 28/71 [07:33<06:39,  9.29s/it]
batch:  41%|████      | 29/71 [08:50<20:36, 29.44s/it]
batch:  42%|████▏     | 30/71 [08:57<15:34, 22.80s/it]
batch:  44%|████▎     | 31/71 [09:05<12:13, 18.35s/it]
batch:  45%|████▌     | 32/71 [09:13<09:59, 15.37s/it]
batch:  46%|████▋     | 33/71 [09:21<08:22, 13.21s/it]
batch:  48%|████▊     | 34/71 [09:30<07:13, 11.71s/it]
batch:  49%|████▉     | 35/71 [09:38<06:21, 10.60s/it]
batch:  51%|█████     | 36/71 [10:55<17:50, 30.59s/it]
batch:  52%|█████▏    | 37/71 [11:03<13:28, 23.78s/it]
batch:  54%|█████▎    | 38/71 [11:11<10:26, 18.98s/it]
batch:  55%|█████▍    | 39/71 [11:19<08:23, 15.73s/it]
batch:  56%|█████▋    | 40/71 [11:26<06:53, 13.33s/it]
batch:  58%|█████▊    | 41/71 [11:34<05:52, 11.73s/it]
batch:  59%|█████▉    | 42/71 [11:42<05:00, 10.36s/it]
batch:  61%|██████    | 43/71 [12:52<13:17, 28.50s/it]
batch:  62%|██████▏   | 44/71 [13:00<10:02, 22.30s/it]
batch:  63%|██████▎   | 45/71 [13:08<07:47, 17.98s/it]
batch:  65%|██████▍   | 46/71 [13:16<06:13, 14.94s/it]
batch:  66%|██████▌   | 47/71 [13:24<05:08, 12.84s/it]
batch:  68%|██████▊   | 48/71 [13:32<04:22, 11.39s/it]
batch:  69%|██████▉   | 49/71 [13:39<03:42, 10.11s/it]
batch:  70%|███████   | 50/71 [14:51<10:01, 28.64s/it]
batch:  72%|███████▏  | 51/71 [14:58<07:21, 22.07s/it]
batch:  73%|███████▎  | 52/71 [15:04<05:31, 17.46s/it]
batch:  75%|███████▍  | 53/71 [15:12<04:21, 14.54s/it]
batch:  76%|███████▌  | 54/71 [15:20<03:31, 12.47s/it]
batch:  77%|███████▋  | 55/71 [15:27<02:54, 10.91s/it]
batch:  79%|███████▉  | 56/71 [15:34<02:24,  9.66s/it]
batch:  80%|████████  | 57/71 [16:46<06:40, 28.60s/it]
batch:  82%|████████▏ | 58/71 [16:54<04:47, 22.13s/it]
batch:  83%|████████▎ | 59/71 [17:00<03:30, 17.56s/it]
batch:  85%|████████▍ | 60/71 [17:07<02:37, 14.35s/it]
batch:  86%|████████▌ | 61/71 [17:14<02:01, 12.11s/it]
batch:  87%|████████▋ | 62/71 [17:21<01:34, 10.50s/it]
batch:  89%|████████▊ | 63/71 [17:28<01:14,  9.35s/it]
batch:  90%|█████████ | 64/71 [18:45<03:27, 29.62s/it]
batch:  92%|█████████▏| 65/71 [18:52<02:18, 23.01s/it]
batch:  93%|█████████▎| 66/71 [19:00<01:31, 18.37s/it]
batch:  94%|█████████▍| 67/71 [19:07<00:59, 14.94s/it]
batch:  96%|█████████▌| 68/71 [19:13<00:37, 12.54s/it]
batch:  97%|█████████▋| 69/71 [19:20<00:21, 10.82s/it]
batch:  99%|█████████▊| 70/71 [19:27<00:09,  9.62s/it]
Top10:Epoch 13: train loss: 9.221	  train recall@20: 0.4095	  train NDCG: 0.2329	  train precision: 0.1937	  train hit: 0.7654	  train mrr: 0.2045
Top10:Epoch 13: valid loss: 8.922	  valid recall@20: 0.277	  valid NDCG: 0.2121	  valid precision: 0.2681	  valid hit: 0.7226	  valid mrr: 0.1861

Top20:Epoch 13: train loss: 9.221	  train recall@20: 0.4738	  train NDCG: 0.2505	  train precision: 0.1155	  train hit: 0.822	  train mrr: 0.2096
Top20:Epoch 13: valid loss: 8.922	  valid recall@20: 0.33	  valid NDCG: 0.2286	  valid precision: 0.161	  valid hit: 0.755	  valid mrr: 0.1908

Top30:Epoch 13: train loss: 9.221	  train recall@20: 0.5133	  train NDCG: 0.2596	  train precision: 0.08494	  train hit: 0.8507	  train mrr: 0.2114
Top30:Epoch 13: valid loss: 8.922	  valid recall@20: 0.3623	  valid NDCG: 0.2374	  valid precision: 0.1189	  valid hit: 0.7685	  valid mrr: 0.1925

batch: 100%|██████████| 71/71 [20:37<00:00, 27.82s/it]
epoch:  90%|█████████ | 18/20 [4:18:50<31:00, 930.23s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]
batch:   1%|▏         | 1/71 [01:13<1:25:38, 73.41s/it]
batch:   3%|▎         | 2/71 [01:21<40:11, 34.95s/it]  
batch:   4%|▍         | 3/71 [01:29<25:39, 22.63s/it]
batch:   6%|▌         | 4/71 [01:37<18:48, 16.84s/it]
batch:   7%|▋         | 5/71 [01:45<14:56, 13.58s/it]
batch:   8%|▊         | 6/71 [01:52<12:15, 11.32s/it]
batch:  10%|▉         | 7/71 [01:59<10:35,  9.93s/it]
batch:  11%|█▏        | 8/71 [03:17<33:20, 31.76s/it]
batch:  13%|█▎        | 9/71 [03:24<24:43, 23.93s/it]
batch:  14%|█▍        | 10/71 [03:30<18:53, 18.58s/it]
batch:  15%|█▌        | 11/71 [03:37<14:56, 14.93s/it]
batch:  17%|█▋        | 12/71 [03:44<12:12, 12.42s/it]
batch:  18%|█▊        | 13/71 [03:50<10:18, 10.67s/it]
batch:  20%|█▉        | 14/71 [03:57<08:57,  9.42s/it]
batch:  21%|██        | 15/71 [05:05<25:18, 27.12s/it]
batch:  23%|██▎       | 16/71 [05:12<19:12, 20.96s/it]
batch:  24%|██▍       | 17/71 [05:20<15:18, 17.01s/it]
batch:  25%|██▌       | 18/71 [05:27<12:30, 14.16s/it]
batch:  27%|██▋       | 19/71 [05:34<10:28, 12.08s/it]
batch:  28%|██▊       | 20/71 [05:42<09:01, 10.61s/it]
batch:  30%|██▉       | 21/71 [05:48<07:52,  9.44s/it]
batch:  31%|███       | 22/71 [07:05<24:07, 29.55s/it]
batch:  32%|███▏      | 23/71 [07:12<18:13, 22.78s/it]
batch:  34%|███▍      | 24/71 [07:19<14:07, 18.03s/it]
batch:  35%|███▌      | 25/71 [07:26<11:15, 14.69s/it]
batch:  37%|███▋      | 26/71 [07:32<09:13, 12.29s/it]
batch:  38%|███▊      | 27/71 [07:39<07:48, 10.64s/it]
batch:  39%|███▉      | 28/71 [07:46<06:46,  9.46s/it]
batch:  41%|████      | 29/71 [08:58<19:47, 28.27s/it]
batch:  42%|████▏     | 30/71 [09:05<14:57, 21.88s/it]
batch:  44%|████▎     | 31/71 [09:12<11:35, 17.38s/it]
batch:  45%|████▌     | 32/71 [09:19<09:15, 14.24s/it]
batch:  46%|████▋     | 33/71 [09:26<07:36, 12.02s/it]
batch:  48%|████▊     | 34/71 [09:33<06:28, 10.51s/it]
batch:  49%|████▉     | 35/71 [09:39<05:38,  9.40s/it]
batch:  51%|█████     | 36/71 [10:57<17:24, 29.85s/it]
batch:  52%|█████▏    | 37/71 [11:04<13:04, 23.08s/it]
batch:  54%|█████▎    | 38/71 [11:11<10:01, 18.24s/it]
batch:  55%|█████▍    | 39/71 [11:18<07:55, 14.85s/it]
batch:  56%|█████▋    | 40/71 [11:25<06:25, 12.45s/it]
batch:  58%|█████▊    | 41/71 [11:32<05:23, 10.80s/it]
batch:  59%|█████▉    | 42/71 [11:39<04:37,  9.59s/it]
batch:  61%|██████    | 43/71 [12:55<13:45, 29.49s/it]
batch:  62%|██████▏   | 44/71 [13:02<10:16, 22.83s/it]
batch:  63%|██████▎   | 45/71 [13:09<07:52, 18.18s/it]
batch:  65%|██████▍   | 46/71 [13:16<06:12, 14.90s/it]
batch:  66%|██████▌   | 47/71 [13:24<05:02, 12.60s/it]
batch:  68%|██████▊   | 48/71 [13:31<04:16, 11.17s/it]
batch:  69%|██████▉   | 49/71 [13:39<03:43, 10.16s/it]
batch:  70%|███████   | 50/71 [14:57<10:36, 30.32s/it]
batch:  72%|███████▏  | 51/71 [15:04<07:50, 23.51s/it]
batch:  73%|███████▎  | 52/71 [15:11<05:52, 18.54s/it]
batch:  75%|███████▍  | 53/71 [15:18<04:30, 15.02s/it]
batch:  76%|███████▌  | 54/71 [15:25<03:33, 12.57s/it]
batch:  77%|███████▋  | 55/71 [15:32<02:56, 11.05s/it]
batch:  79%|███████▉  | 56/71 [15:40<02:30, 10.02s/it]
batch:  80%|████████  | 57/71 [17:03<07:26, 31.90s/it]
batch:  82%|████████▏ | 58/71 [17:10<05:18, 24.51s/it]
batch:  83%|████████▎ | 59/71 [17:17<03:50, 19.25s/it]
batch:  85%|████████▍ | 60/71 [17:24<02:51, 15.56s/it]
batch:  86%|████████▌ | 61/71 [17:31<02:09, 12.95s/it]
batch:  87%|████████▋ | 62/71 [17:38<01:40, 11.16s/it]
batch:  89%|████████▊ | 63/71 [17:45<01:19,  9.93s/it]
batch:  90%|█████████ | 64/71 [19:02<03:29, 29.99s/it]
batch:  92%|█████████▏| 65/71 [19:09<02:19, 23.25s/it]
batch:  93%|█████████▎| 66/71 [19:16<01:32, 18.42s/it]
batch:  94%|█████████▍| 67/71 [19:24<01:00, 15.04s/it]
batch:  96%|█████████▌| 68/71 [19:31<00:38, 12.72s/it]
batch:  97%|█████████▋| 69/71 [19:39<00:22, 11.31s/it]
batch:  99%|█████████▊| 70/71 [19:47<00:10, 10.30s/it]
batch: 100%|██████████| 71/71 [21:15<00:00, 33.55s/it]
epoch:  95%|█████████▌| 19/20 [4:40:05<16:56, 1016.65s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 14: train loss: 9.161	  train recall@20: 0.4231	  train NDCG: 0.2455	  train precision: 0.2035	  train hit: 0.7782	  train mrr: 0.2157
Top10:Epoch 14: valid loss: 8.835	  valid recall@20: 0.292	  valid NDCG: 0.2248	  valid precision: 0.2833	  valid hit: 0.7329	  valid mrr: 0.1976

Top20:Epoch 14: train loss: 9.161	  train recall@20: 0.4886	  train NDCG: 0.2637	  train precision: 0.1209	  train hit: 0.8331	  train mrr: 0.221
Top20:Epoch 14: valid loss: 8.835	  valid recall@20: 0.3444	  valid NDCG: 0.2416	  valid precision: 0.169	  valid hit: 0.7588	  valid mrr: 0.2025

Top30:Epoch 14: train loss: 9.161	  train recall@20: 0.5297	  train NDCG: 0.273	  train precision: 0.08888	  train hit: 0.8573	  train mrr: 0.2227
Top30:Epoch 14: valid loss: 8.835	  valid recall@20: 0.3779	  valid NDCG: 0.2505	  valid precision: 0.1245	  valid hit: 0.7715	  valid mrr: 0.2042


batch:   1%|▏         | 1/71 [01:19<1:32:34, 79.36s/it]
batch:   3%|▎         | 2/71 [01:27<42:48, 37.23s/it]  
batch:   4%|▍         | 3/71 [01:35<27:05, 23.91s/it]
batch:   6%|▌         | 4/71 [01:43<19:41, 17.63s/it]
batch:   7%|▋         | 5/71 [01:51<15:38, 14.22s/it]
batch:   8%|▊         | 6/71 [01:59<13:10, 12.16s/it]
batch:  10%|▉         | 7/71 [02:07<11:34, 10.85s/it]
batch:  11%|█▏        | 8/71 [03:35<37:11, 35.41s/it]
batch:  13%|█▎        | 9/71 [03:42<27:23, 26.51s/it]
batch:  14%|█▍        | 10/71 [03:49<20:50, 20.50s/it]
batch:  15%|█▌        | 11/71 [03:56<16:27, 16.46s/it]
batch:  17%|█▋        | 12/71 [04:03<13:20, 13.56s/it]
batch:  18%|█▊        | 13/71 [04:11<11:14, 11.63s/it]
batch:  20%|█▉        | 14/71 [04:18<09:47, 10.31s/it]
batch:  21%|██        | 15/71 [05:36<28:48, 30.86s/it]
batch:  23%|██▎       | 16/71 [05:44<21:55, 23.91s/it]
batch:  24%|██▍       | 17/71 [05:52<17:13, 19.13s/it]
batch:  25%|██▌       | 18/71 [06:00<13:50, 15.67s/it]
batch:  27%|██▋       | 19/71 [06:07<11:25, 13.18s/it]
batch:  28%|██▊       | 20/71 [06:15<09:46, 11.49s/it]
batch:  30%|██▉       | 21/71 [06:22<08:35, 10.31s/it]
batch:  31%|███       | 22/71 [07:39<24:38, 30.16s/it]
batch:  32%|███▏      | 23/71 [07:45<18:30, 23.14s/it]
batch:  34%|███▍      | 24/71 [07:53<14:28, 18.47s/it]
batch:  35%|███▌      | 25/71 [08:01<11:43, 15.29s/it]
batch:  37%|███▋      | 26/71 [08:09<09:55, 13.23s/it]
batch:  38%|███▊      | 27/71 [08:18<08:36, 11.73s/it]
batch:  39%|███▉      | 28/71 [08:26<07:37, 10.64s/it]
batch:  41%|████      | 29/71 [09:47<22:23, 31.98s/it]
batch:  42%|████▏     | 30/71 [09:55<16:52, 24.69s/it]
batch:  44%|████▎     | 31/71 [10:02<12:56, 19.41s/it]
batch:  45%|████▌     | 32/71 [10:10<10:20, 15.90s/it]
batch:  46%|████▋     | 33/71 [10:18<08:35, 13.57s/it]
batch:  48%|████▊     | 34/71 [10:26<07:20, 11.90s/it]
batch:  49%|████▉     | 35/71 [10:34<06:26, 10.73s/it]
batch:  51%|█████     | 36/71 [11:48<17:20, 29.73s/it]
batch:  52%|█████▏    | 37/71 [11:55<13:00, 22.97s/it]
batch:  54%|█████▎    | 38/71 [12:03<10:05, 18.34s/it]
batch:  55%|█████▍    | 39/71 [12:10<08:03, 15.12s/it]
batch:  56%|█████▋    | 40/71 [12:17<06:33, 12.69s/it]
batch:  58%|█████▊    | 41/71 [12:25<05:31, 11.04s/it]
batch:  59%|█████▉    | 42/71 [12:32<04:49,  9.98s/it]
batch:  61%|██████    | 43/71 [13:46<13:40, 29.29s/it]
batch:  62%|██████▏   | 44/71 [13:53<10:08, 22.53s/it]
batch:  63%|██████▎   | 45/71 [14:00<07:42, 17.80s/it]
batch:  65%|██████▍   | 46/71 [14:07<06:01, 14.48s/it]
batch:  66%|██████▌   | 47/71 [14:14<04:54, 12.26s/it]
batch:  68%|██████▊   | 48/71 [14:21<04:06, 10.73s/it]
batch:  69%|██████▉   | 49/71 [14:28<03:30,  9.55s/it]
batch:  70%|███████   | 50/71 [15:44<10:23, 29.70s/it]
batch:  72%|███████▏  | 51/71 [15:52<07:40, 23.01s/it]
batch:  73%|███████▎  | 52/71 [15:59<05:48, 18.33s/it]
batch:  75%|███████▍  | 53/71 [16:08<04:36, 15.36s/it]
batch:  76%|███████▌  | 54/71 [16:16<03:44, 13.20s/it]
batch:  77%|███████▋  | 55/71 [16:24<03:05, 11.62s/it]
batch:  79%|███████▉  | 56/71 [16:31<02:34, 10.31s/it]
batch:  80%|████████  | 57/71 [17:45<06:49, 29.27s/it]
batch:  82%|████████▏ | 58/71 [17:51<04:53, 22.56s/it]
batch:  83%|████████▎ | 59/71 [17:58<03:33, 17.83s/it]
batch:  85%|████████▍ | 60/71 [18:05<02:39, 14.50s/it]
batch:  86%|████████▌ | 61/71 [18:12<02:01, 12.18s/it]
batch:  87%|████████▋ | 62/71 [18:19<01:34, 10.55s/it]
batch:  89%|████████▊ | 63/71 [18:26<01:15,  9.50s/it]
batch:  90%|█████████ | 64/71 [19:38<03:19, 28.49s/it]
batch:  92%|█████████▏| 65/71 [19:45<02:11, 21.94s/it]
batch:  93%|█████████▎| 66/71 [19:52<01:26, 17.38s/it]
batch:  94%|█████████▍| 67/71 [19:59<00:56, 14.19s/it]
batch:  96%|█████████▌| 68/71 [20:06<00:36, 12.11s/it]
batch:  97%|█████████▋| 69/71 [20:14<00:21, 10.99s/it]
batch:  99%|█████████▊| 70/71 [20:22<00:10, 10.12s/it]
batch: 100%|██████████| 71/71 [21:46<00:00, 32.21s/it]
epoch: 100%|██████████| 20/20 [5:01:52<00:00, 1093.04s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 15: train loss: 9.116	  train recall@20: 0.4375	  train NDCG: 0.2561	  train precision: 0.2127	  train hit: 0.7894	  train mrr: 0.2248
Top10:Epoch 15: valid loss: 8.784	  valid recall@20: 0.3053	  valid NDCG: 0.2353	  valid precision: 0.2974	  valid hit: 0.7406	  valid mrr: 0.2067

Top20:Epoch 15: train loss: 9.116	  train recall@20: 0.5061	  train NDCG: 0.2751	  train precision: 0.1264	  train hit: 0.8425	  train mrr: 0.2303
Top20:Epoch 15: valid loss: 8.784	  valid recall@20: 0.3578	  valid NDCG: 0.2525	  valid precision: 0.1763	  valid hit: 0.7644	  valid mrr: 0.2117

Top30:Epoch 15: train loss: 9.116	  train recall@20: 0.5465	  train NDCG: 0.2844	  train precision: 0.09245	  train hit: 0.8662	  train mrr: 0.2321
Top30:Epoch 15: valid loss: 8.784	  valid recall@20: 0.393	  valid NDCG: 0.262	  valid precision: 0.1302	  valid hit: 0.7729	  valid mrr: 0.2135


batch:   1%|▏         | 1/71 [01:19<1:32:45, 79.51s/it]
batch:   3%|▎         | 2/71 [01:27<43:00, 37.40s/it]  
batch:   4%|▍         | 3/71 [01:35<27:04, 23.89s/it]
batch:   6%|▌         | 4/71 [01:43<19:46, 17.71s/it]
batch:   7%|▋         | 5/71 [01:50<15:25, 14.03s/it]
batch:   8%|▊         | 6/71 [01:57<12:34, 11.60s/it]
batch:  10%|▉         | 7/71 [02:06<11:10, 10.48s/it]
batch:  11%|█▏        | 8/71 [03:29<35:30, 33.82s/it]
batch:  13%|█▎        | 9/71 [03:37<26:22, 25.53s/it]
batch:  14%|█▍        | 10/71 [03:45<20:28, 20.15s/it]
batch:  15%|█▌        | 11/71 [03:53<16:26, 16.45s/it]
batch:  17%|█▋        | 12/71 [04:00<13:33, 13.79s/it]
batch:  18%|█▊        | 13/71 [04:09<11:41, 12.09s/it]
batch:  20%|█▉        | 14/71 [04:16<10:15, 10.80s/it]
batch:  21%|██        | 15/71 [05:34<28:49, 30.88s/it]
batch:  23%|██▎       | 16/71 [05:41<21:43, 23.70s/it]
batch:  24%|██▍       | 17/71 [05:49<17:07, 19.02s/it]
batch:  25%|██▌       | 18/71 [05:57<13:52, 15.70s/it]
batch:  27%|██▋       | 19/71 [06:05<11:36, 13.40s/it]
batch:  28%|██▊       | 20/71 [06:13<10:01, 11.80s/it]
batch:  30%|██▉       | 21/71 [06:21<08:54, 10.69s/it]
batch:  31%|███       | 22/71 [07:46<26:50, 32.86s/it]
batch:  32%|███▏      | 23/71 [07:54<20:21, 25.46s/it]
batch:  34%|███▍      | 24/71 [08:02<15:46, 20.15s/it]
batch:  35%|███▌      | 25/71 [08:09<12:33, 16.37s/it]
batch:  37%|███▋      | 26/71 [08:16<10:09, 13.55s/it]
batch:  38%|███▊      | 27/71 [08:23<08:27, 11.53s/it]
batch:  39%|███▉      | 28/71 [08:30<07:14, 10.11s/it]
batch:  41%|████      | 29/71 [09:45<20:38, 29.48s/it]
batch:  42%|████▏     | 30/71 [09:54<15:56, 23.34s/it]
batch:  44%|████▎     | 31/71 [10:01<12:22, 18.57s/it]
batch:  45%|████▌     | 32/71 [10:08<09:48, 15.10s/it]
batch:  46%|████▋     | 33/71 [10:15<07:59, 12.63s/it]
batch:  48%|████▊     | 34/71 [10:22<06:47, 11.02s/it]
batch:  49%|████▉     | 35/71 [10:29<05:54,  9.83s/it]
batch:  51%|█████     | 36/71 [11:48<17:47, 30.50s/it]
batch:  52%|█████▏    | 37/71 [11:56<13:23, 23.62s/it]
batch:  54%|█████▎    | 38/71 [12:03<10:19, 18.77s/it]
batch:  55%|█████▍    | 39/71 [12:11<08:20, 15.63s/it]
batch:  56%|█████▋    | 40/71 [12:19<06:55, 13.39s/it]
batch:  58%|█████▊    | 41/71 [12:27<05:48, 11.63s/it]
batch:  59%|█████▉    | 42/71 [12:35<05:04, 10.50s/it]
batch:  61%|██████    | 43/71 [13:51<14:04, 30.16s/it]
batch:  62%|██████▏   | 44/71 [13:58<10:25, 23.17s/it]
batch:  63%|██████▎   | 45/71 [14:05<07:54, 18.27s/it]
batch:  65%|██████▍   | 46/71 [14:11<06:10, 14.83s/it]
batch:  66%|██████▌   | 47/71 [14:18<04:58, 12.43s/it]
batch:  68%|██████▊   | 48/71 [14:25<04:07, 10.74s/it]
batch:  69%|██████▉   | 49/71 [14:32<03:29,  9.53s/it]
batch:  70%|███████   | 50/71 [15:43<09:48, 28.04s/it]
batch:  72%|███████▏  | 51/71 [15:50<07:13, 21.66s/it]
batch:  73%|███████▎  | 52/71 [15:57<05:26, 17.21s/it]
batch:  75%|███████▍  | 53/71 [16:04<04:15, 14.22s/it]
batch:  76%|███████▌  | 54/71 [16:11<03:24, 12.01s/it]
batch:  77%|███████▋  | 55/71 [16:18<02:48, 10.54s/it]
batch:  79%|███████▉  | 56/71 [16:24<02:20,  9.36s/it]
batch:  80%|████████  | 57/71 [17:38<06:42, 28.75s/it]
batch:  82%|████████▏ | 58/71 [17:45<04:48, 22.16s/it]
batch:  83%|████████▎ | 59/71 [17:52<03:30, 17.56s/it]
batch:  85%|████████▍ | 60/71 [17:59<02:37, 14.33s/it]
batch:  86%|████████▌ | 61/71 [18:06<02:02, 12.21s/it]
batch:  87%|████████▋ | 62/71 [18:13<01:37, 10.80s/it]
batch:  89%|████████▊ | 63/71 [18:20<01:17,  9.64s/it]
batch:  90%|█████████ | 64/71 [19:40<03:35, 30.73s/it]
batch:  92%|█████████▏| 65/71 [19:48<02:23, 23.92s/it]
batch:  93%|█████████▎| 66/71 [19:57<01:36, 19.22s/it]
batch:  94%|█████████▍| 67/71 [20:05<01:03, 15.87s/it]
batch:  96%|█████████▌| 68/71 [20:12<00:39, 13.29s/it]
batch:  97%|█████████▋| 69/71 [20:20<00:23, 11.60s/it]
batch:  99%|█████████▊| 70/71 [20:28<00:10, 10.58s/it]
batch: 100%|██████████| 71/71 [21:54<00:00, 33.11s/it]
epoch: 21it [5:23:46, 1153.48s/it]                        
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 16: train loss: 9.066	  train recall@20: 0.4483	  train NDCG: 0.2654	  train precision: 0.2218	  train hit: 0.7961	  train mrr: 0.233
Top10:Epoch 16: valid loss: 8.892	  valid recall@20: 0.3146	  valid NDCG: 0.2434	  valid precision: 0.308	  valid hit: 0.7432	  valid mrr: 0.2141

Top20:Epoch 16: train loss: 9.066	  train recall@20: 0.5182	  train NDCG: 0.2849	  train precision: 0.1312	  train hit: 0.8479	  train mrr: 0.2387
Top20:Epoch 16: valid loss: 8.892	  valid recall@20: 0.3695	  valid NDCG: 0.2612	  valid precision: 0.1824	  valid hit: 0.7659	  valid mrr: 0.2192

Top30:Epoch 16: train loss: 9.066	  train recall@20: 0.5599	  train NDCG: 0.2947	  train precision: 0.096	  train hit: 0.871	  train mrr: 0.2406
Top30:Epoch 16: valid loss: 8.892	  valid recall@20: 0.4044	  valid NDCG: 0.2704	  valid precision: 0.1339	  valid hit: 0.775	  valid mrr: 0.221


batch:   1%|▏         | 1/71 [01:15<1:28:08, 75.55s/it]
batch:   3%|▎         | 2/71 [01:22<40:46, 35.45s/it]  
batch:   4%|▍         | 3/71 [01:30<25:29, 22.50s/it]
batch:   6%|▌         | 4/71 [01:37<18:19, 16.41s/it]
batch:   7%|▋         | 5/71 [01:44<14:20, 13.03s/it]
batch:   8%|▊         | 6/71 [01:51<11:52, 10.96s/it]
batch:  10%|▉         | 7/71 [01:57<10:16,  9.63s/it]
batch:  11%|█▏        | 8/71 [03:11<31:25, 29.92s/it]
batch:  13%|█▎        | 9/71 [03:18<23:34, 22.82s/it]
batch:  14%|█▍        | 10/71 [03:25<18:13, 17.92s/it]
batch:  15%|█▌        | 11/71 [03:32<14:33, 14.56s/it]
batch:  17%|█▋        | 12/71 [03:39<12:01, 12.24s/it]
batch:  18%|█▊        | 13/71 [03:46<10:16, 10.63s/it]
batch:  20%|█▉        | 14/71 [03:53<09:04,  9.55s/it]
batch:  21%|██        | 15/71 [05:08<27:29, 29.46s/it]
batch:  23%|██▎       | 16/71 [05:16<20:52, 22.78s/it]
batch:  24%|██▍       | 17/71 [05:23<16:25, 18.25s/it]
batch:  25%|██▌       | 18/71 [05:31<13:12, 14.95s/it]
batch:  27%|██▋       | 19/71 [05:39<11:10, 12.89s/it]
batch:  28%|██▊       | 20/71 [05:48<09:54, 11.66s/it]
batch:  30%|██▉       | 21/71 [05:56<08:59, 10.79s/it]
batch:  31%|███       | 22/71 [07:18<26:11, 32.08s/it]
batch:  32%|███▏      | 23/71 [07:26<19:48, 24.76s/it]
batch:  34%|███▍      | 24/71 [07:33<15:20, 19.59s/it]
batch:  35%|███▌      | 25/71 [07:41<12:21, 16.13s/it]
batch:  37%|███▋      | 26/71 [07:49<10:15, 13.68s/it]
batch:  38%|███▊      | 27/71 [07:57<08:45, 11.93s/it]
batch:  39%|███▉      | 28/71 [08:05<07:35, 10.59s/it]
batch:  41%|████      | 29/71 [09:22<21:28, 30.68s/it]
batch:  42%|████▏     | 30/71 [09:31<16:23, 24.00s/it]
batch:  44%|████▎     | 31/71 [09:38<12:44, 19.12s/it]
batch:  45%|████▌     | 32/71 [09:45<10:03, 15.48s/it]
batch:  46%|████▋     | 33/71 [09:52<08:09, 12.88s/it]
batch:  48%|████▊     | 34/71 [09:59<06:54, 11.21s/it]
batch:  49%|████▉     | 35/71 [10:07<05:59,  9.99s/it]
batch:  51%|█████     | 36/71 [11:24<17:39, 30.27s/it]
batch:  52%|█████▏    | 37/71 [11:31<13:10, 23.25s/it]
batch:  54%|█████▎    | 38/71 [11:38<10:06, 18.37s/it]
batch:  55%|█████▍    | 39/71 [11:45<07:57, 14.93s/it]
batch:  56%|█████▋    | 40/71 [11:52<06:26, 12.48s/it]
batch:  58%|█████▊    | 41/71 [11:58<05:23, 10.79s/it]
batch:  59%|█████▉    | 42/71 [12:05<04:38,  9.59s/it]
batch:  61%|██████    | 43/71 [13:19<13:24, 28.74s/it]
batch:  62%|██████▏   | 44/71 [13:26<09:59, 22.19s/it]
batch:  63%|██████▎   | 45/71 [13:33<07:37, 17.60s/it]
batch:  65%|██████▍   | 46/71 [13:39<05:59, 14.36s/it]
batch:  66%|██████▌   | 47/71 [13:46<04:50, 12.12s/it]
batch:  68%|██████▊   | 48/71 [13:53<04:02, 10.57s/it]
batch:  69%|██████▉   | 49/71 [14:00<03:28,  9.49s/it]
batch:  70%|███████   | 50/71 [15:13<09:55, 28.36s/it]
batch:  72%|███████▏  | 51/71 [15:20<07:19, 21.96s/it]
batch:  73%|███████▎  | 52/71 [15:26<05:31, 17.45s/it]
batch:  75%|███████▍  | 53/71 [15:34<04:18, 14.33s/it]
batch:  76%|███████▌  | 54/71 [15:41<03:26, 12.13s/it]
batch:  77%|███████▋  | 55/71 [15:47<02:48, 10.55s/it]
batch:  79%|███████▉  | 56/71 [15:54<02:22,  9.48s/it]
batch:  80%|████████  | 57/71 [17:08<06:40, 28.59s/it]
batch:  82%|████████▏ | 58/71 [17:15<04:47, 22.13s/it]
batch:  83%|████████▎ | 59/71 [17:22<03:30, 17.58s/it]
batch:  85%|████████▍ | 60/71 [17:28<02:38, 14.38s/it]
batch:  86%|████████▌ | 61/71 [17:35<02:01, 12.13s/it]
batch:  87%|████████▋ | 62/71 [17:42<01:35, 10.60s/it]
batch:  89%|████████▊ | 63/71 [17:50<01:18,  9.83s/it]
batch:  90%|█████████ | 64/71 [19:06<03:26, 29.43s/it]
batch:  92%|█████████▏| 65/71 [19:13<02:17, 22.85s/it]
batch:  93%|█████████▎| 66/71 [19:20<01:30, 18.12s/it]
batch:  94%|█████████▍| 67/71 [19:27<00:58, 14.73s/it]
batch:  96%|█████████▌| 68/71 [19:34<00:37, 12.36s/it]
batch:  97%|█████████▋| 69/71 [19:41<00:21, 10.70s/it]
batch:  99%|█████████▊| 70/71 [19:47<00:09,  9.53s/it]
Top10:Epoch 17: train loss: 9.03	  train recall@20: 0.458	  train NDCG: 0.275	  train precision: 0.2281	  train hit: 0.8034	  train mrr: 0.2416
Top10:Epoch 17: valid loss: 8.838	  valid recall@20: 0.3258	  valid NDCG: 0.2529	  valid precision: 0.3202	  valid hit: 0.7497	  valid mrr: 0.2224

Top20:Epoch 17: train loss: 9.03	  train recall@20: 0.5315	  train NDCG: 0.2953	  train precision: 0.1354	  train hit: 0.8515	  train mrr: 0.2475
Top20:Epoch 17: valid loss: 8.838	  valid recall@20: 0.3827	  valid NDCG: 0.2713	  valid precision: 0.1895	  valid hit: 0.7682	  valid mrr: 0.2277

Top30:Epoch 17: train loss: 9.03	  train recall@20: 0.5729	  train NDCG: 0.3052	  train precision: 0.09892	  train hit: 0.8751	  train mrr: 0.2494
Top30:Epoch 17: valid loss: 8.838	  valid recall@20: 0.4175	  valid NDCG: 0.2808	  valid precision: 0.1387	  valid hit: 0.7779	  valid mrr: 0.2296

batch: 100%|██████████| 71/71 [21:01<00:00, 28.67s/it]
epoch: 23it [5:44:47, 924.13s/it] 
batch:   0%|          | 0/71 [00:00<?, ?it/s]
batch:   1%|▏         | 1/71 [01:22<1:36:37, 82.82s/it]
batch:   3%|▎         | 2/71 [01:30<44:10, 38.41s/it]  
batch:   4%|▍         | 3/71 [01:37<27:19, 24.10s/it]
batch:   6%|▌         | 4/71 [01:44<19:25, 17.40s/it]
batch:   7%|▋         | 5/71 [01:51<14:54, 13.56s/it]
batch:   8%|▊         | 6/71 [01:57<12:11, 11.25s/it]
batch:  10%|▉         | 7/71 [02:04<10:26,  9.79s/it]
batch:  11%|█▏        | 8/71 [03:22<33:03, 31.49s/it]
batch:  13%|█▎        | 9/71 [03:30<24:52, 24.07s/it]
batch:  14%|█▍        | 10/71 [03:38<19:20, 19.02s/it]
batch:  15%|█▌        | 11/71 [03:45<15:28, 15.47s/it]
batch:  17%|█▋        | 12/71 [03:53<12:50, 13.06s/it]
batch:  18%|█▊        | 13/71 [04:01<11:13, 11.61s/it]
batch:  20%|█▉        | 14/71 [04:09<09:57, 10.48s/it]
batch:  21%|██        | 15/71 [05:29<29:22, 31.48s/it]
batch:  23%|██▎       | 16/71 [05:36<22:01, 24.02s/it]
batch:  24%|██▍       | 17/71 [05:42<16:59, 18.89s/it]
batch:  25%|██▌       | 18/71 [05:49<13:30, 15.29s/it]
batch:  27%|██▋       | 19/71 [05:57<11:09, 12.88s/it]
batch:  28%|██▊       | 20/71 [06:05<09:48, 11.53s/it]
batch:  30%|██▉       | 21/71 [06:13<08:49, 10.58s/it]
batch:  31%|███       | 22/71 [07:35<26:07, 31.98s/it]
batch:  32%|███▏      | 23/71 [07:43<19:45, 24.71s/it]
batch:  34%|███▍      | 24/71 [07:51<15:29, 19.78s/it]
batch:  35%|███▌      | 25/71 [08:00<12:32, 16.37s/it]
batch:  37%|███▋      | 26/71 [08:07<10:16, 13.70s/it]
batch:  38%|███▊      | 27/71 [08:14<08:38, 11.78s/it]
batch:  39%|███▉      | 28/71 [08:22<07:27, 10.40s/it]
batch:  41%|████      | 29/71 [09:41<21:44, 31.05s/it]
batch:  42%|████▏     | 30/71 [09:49<16:26, 24.05s/it]
batch:  44%|████▎     | 31/71 [09:56<12:40, 19.01s/it]
batch:  45%|████▌     | 32/71 [10:03<10:00, 15.39s/it]
batch:  46%|████▋     | 33/71 [10:10<08:12, 12.97s/it]
batch:  48%|████▊     | 34/71 [10:18<07:00, 11.37s/it]
batch:  49%|████▉     | 35/71 [10:25<06:07, 10.20s/it]
batch:  51%|█████     | 36/71 [11:42<17:35, 30.16s/it]
batch:  52%|█████▏    | 37/71 [11:49<13:14, 23.36s/it]
batch:  54%|█████▎    | 38/71 [11:56<10:08, 18.45s/it]
batch:  55%|█████▍    | 39/71 [12:03<07:58, 14.96s/it]
batch:  56%|█████▋    | 40/71 [12:10<06:29, 12.56s/it]
batch:  58%|█████▊    | 41/71 [12:17<05:26, 10.90s/it]
batch:  59%|█████▉    | 42/71 [12:24<04:42,  9.75s/it]
batch:  61%|██████    | 43/71 [13:36<13:09, 28.20s/it]
batch:  62%|██████▏   | 44/71 [13:42<09:48, 21.81s/it]
batch:  63%|██████▎   | 45/71 [13:50<07:35, 17.52s/it]
batch:  65%|██████▍   | 46/71 [13:58<06:05, 14.64s/it]
batch:  66%|██████▌   | 47/71 [14:05<04:59, 12.49s/it]
batch:  68%|██████▊   | 48/71 [14:13<04:12, 10.99s/it]
batch:  69%|██████▉   | 49/71 [14:21<03:40, 10.01s/it]
batch:  70%|███████   | 50/71 [15:43<11:04, 31.63s/it]
batch:  72%|███████▏  | 51/71 [15:50<08:08, 24.42s/it]
batch:  73%|███████▎  | 52/71 [15:57<06:05, 19.25s/it]
batch:  75%|███████▍  | 53/71 [16:05<04:41, 15.63s/it]
batch:  76%|███████▌  | 54/71 [16:12<03:41, 13.00s/it]
batch:  77%|███████▋  | 55/71 [16:18<02:58, 11.17s/it]
batch:  79%|███████▉  | 56/71 [16:25<02:27,  9.87s/it]
batch:  80%|████████  | 57/71 [17:44<07:06, 30.48s/it]
batch:  82%|████████▏ | 58/71 [17:51<05:05, 23.48s/it]
batch:  83%|████████▎ | 59/71 [17:58<03:44, 18.68s/it]
batch:  85%|████████▍ | 60/71 [18:06<02:47, 15.25s/it]
batch:  86%|████████▌ | 61/71 [18:13<02:07, 12.75s/it]
batch:  87%|████████▋ | 62/71 [18:20<01:39, 11.04s/it]
batch:  89%|████████▊ | 63/71 [18:27<01:20, 10.07s/it]
batch:  90%|█████████ | 64/71 [19:54<03:51, 33.07s/it]
batch:  92%|█████████▏| 65/71 [20:02<02:33, 25.52s/it]
batch:  93%|█████████▎| 66/71 [20:10<01:41, 20.30s/it]
batch:  94%|█████████▍| 67/71 [20:18<01:06, 16.56s/it]
batch:  96%|█████████▌| 68/71 [20:26<00:41, 13.91s/it]
batch:  97%|█████████▋| 69/71 [20:33<00:23, 11.91s/it]
batch:  99%|█████████▊| 70/71 [20:41<00:10, 10.73s/it]
batch: 100%|██████████| 71/71 [22:02<00:00, 31.84s/it]
epoch: 24it [6:06:49, 1019.20s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 18: train loss: 8.999	  train recall@20: 0.4648	  train NDCG: 0.2817	  train precision: 0.2338	  train hit: 0.8077	  train mrr: 0.2476
Top10:Epoch 18: valid loss: 8.812	  valid recall@20: 0.3332	  valid NDCG: 0.261	  valid precision: 0.3278	  valid hit: 0.7491	  valid mrr: 0.2303

Top20:Epoch 18: train loss: 8.999	  train recall@20: 0.5399	  train NDCG: 0.3022	  train precision: 0.1385	  train hit: 0.8568	  train mrr: 0.2535
Top20:Epoch 18: valid loss: 8.812	  valid recall@20: 0.3904	  valid NDCG: 0.2792	  valid precision: 0.1938	  valid hit: 0.7706	  valid mrr: 0.2355

Top30:Epoch 18: train loss: 8.999	  train recall@20: 0.5824	  train NDCG: 0.3121	  train precision: 0.1011	  train hit: 0.8803	  train mrr: 0.2555
Top30:Epoch 18: valid loss: 8.812	  valid recall@20: 0.4268	  valid NDCG: 0.2892	  valid precision: 0.142	  valid hit: 0.7779	  valid mrr: 0.2375


batch:   1%|▏         | 1/71 [01:19<1:33:06, 79.81s/it]
batch:   3%|▎         | 2/71 [01:27<42:58, 37.37s/it]  
batch:   4%|▍         | 3/71 [01:35<27:08, 23.95s/it]
batch:   6%|▌         | 4/71 [01:43<19:40, 17.62s/it]
batch:   7%|▋         | 5/71 [01:51<15:31, 14.12s/it]
batch:   8%|▊         | 6/71 [01:59<13:03, 12.06s/it]
batch:  10%|▉         | 7/71 [02:07<11:23, 10.68s/it]
batch:  11%|█▏        | 8/71 [03:29<35:08, 33.47s/it]
batch:  13%|█▎        | 9/71 [03:36<26:01, 25.18s/it]
batch:  14%|█▍        | 10/71 [03:43<19:51, 19.54s/it]
batch:  15%|█▌        | 11/71 [03:50<15:38, 15.64s/it]
batch:  17%|█▋        | 12/71 [03:56<12:44, 12.96s/it]
batch:  18%|█▊        | 13/71 [04:03<10:43, 11.10s/it]
batch:  20%|█▉        | 14/71 [04:11<09:29,  9.99s/it]
batch:  21%|██        | 15/71 [05:34<30:00, 32.16s/it]
batch:  23%|██▎       | 16/71 [05:42<22:46, 24.85s/it]
batch:  24%|██▍       | 17/71 [05:50<17:39, 19.63s/it]
batch:  25%|██▌       | 18/71 [05:58<14:15, 16.15s/it]
batch:  27%|██▋       | 19/71 [06:06<12:01, 13.88s/it]
batch:  28%|██▊       | 20/71 [06:15<10:25, 12.27s/it]
batch:  30%|██▉       | 21/71 [06:23<09:09, 11.00s/it]
batch:  31%|███       | 22/71 [07:44<26:09, 32.02s/it]
batch:  32%|███▏      | 23/71 [07:51<19:35, 24.50s/it]
batch:  34%|███▍      | 24/71 [07:58<15:07, 19.30s/it]
batch:  35%|███▌      | 25/71 [08:06<12:07, 15.81s/it]
batch:  37%|███▋      | 26/71 [08:13<10:00, 13.33s/it]
batch:  38%|███▊      | 27/71 [08:21<08:35, 11.71s/it]
batch:  39%|███▉      | 28/71 [08:29<07:32, 10.52s/it]
batch:  41%|████      | 29/71 [09:55<23:21, 33.36s/it]
batch:  42%|████▏     | 30/71 [10:03<17:31, 25.65s/it]
batch:  44%|████▎     | 31/71 [10:11<13:33, 20.34s/it]
batch:  45%|████▌     | 32/71 [10:19<10:50, 16.67s/it]
batch:  46%|████▋     | 33/71 [10:27<08:52, 14.01s/it]
batch:  48%|████▊     | 34/71 [10:34<07:24, 12.02s/it]
batch:  49%|████▉     | 35/71 [10:42<06:22, 10.61s/it]
batch:  51%|█████     | 36/71 [12:07<19:15, 33.01s/it]
batch:  52%|█████▏    | 37/71 [12:15<14:23, 25.40s/it]
batch:  54%|█████▎    | 38/71 [12:22<10:58, 19.97s/it]
batch:  55%|█████▍    | 39/71 [12:30<08:43, 16.37s/it]
batch:  56%|█████▋    | 40/71 [12:38<07:06, 13.76s/it]
batch:  58%|█████▊    | 41/71 [12:45<05:54, 11.80s/it]
batch:  59%|█████▉    | 42/71 [12:52<05:00, 10.37s/it]
batch:  61%|██████    | 43/71 [14:05<13:38, 29.24s/it]
batch:  62%|██████▏   | 44/71 [14:13<10:17, 22.86s/it]
batch:  63%|██████▎   | 45/71 [14:22<08:05, 18.66s/it]
batch:  65%|██████▍   | 46/71 [14:30<06:30, 15.61s/it]
batch:  66%|██████▌   | 47/71 [14:39<05:22, 13.43s/it]
batch:  68%|██████▊   | 48/71 [14:47<04:31, 11.81s/it]
batch:  69%|██████▉   | 49/71 [14:55<03:55, 10.69s/it]
batch:  70%|███████   | 50/71 [16:14<10:54, 31.18s/it]
batch:  72%|███████▏  | 51/71 [16:21<07:57, 23.86s/it]
batch:  73%|███████▎  | 52/71 [16:28<05:56, 18.76s/it]
batch:  75%|███████▍  | 53/71 [16:34<04:32, 15.15s/it]
batch:  76%|███████▌  | 54/71 [16:41<03:34, 12.63s/it]
batch:  77%|███████▋  | 55/71 [16:49<02:58, 11.15s/it]
batch:  79%|███████▉  | 56/71 [16:57<02:33, 10.25s/it]
batch:  80%|████████  | 57/71 [18:14<07:05, 30.38s/it]
batch:  82%|████████▏ | 58/71 [18:22<05:06, 23.61s/it]
batch:  83%|████████▎ | 59/71 [18:30<03:45, 18.79s/it]
batch:  85%|████████▍ | 60/71 [18:37<02:49, 15.37s/it]
batch:  86%|████████▌ | 61/71 [18:44<02:08, 12.89s/it]
batch:  87%|████████▋ | 62/71 [18:51<01:40, 11.16s/it]
batch:  89%|████████▊ | 63/71 [18:58<01:18,  9.83s/it]
batch:  90%|█████████ | 64/71 [20:19<03:37, 31.13s/it]
batch:  92%|█████████▏| 65/71 [20:26<02:24, 24.02s/it]
batch:  93%|█████████▎| 66/71 [20:33<01:34, 18.87s/it]
batch:  94%|█████████▍| 67/71 [20:40<01:01, 15.44s/it]
batch:  96%|█████████▌| 68/71 [20:49<00:39, 13.22s/it]
batch:  97%|█████████▋| 69/71 [20:56<00:22, 11.50s/it]
batch:  99%|█████████▊| 70/71 [21:03<00:10, 10.24s/it]
batch: 100%|██████████| 71/71 [22:17<00:00, 29.23s/it]
epoch: 25it [6:29:07, 1100.06s/it]
batch:   0%|          | 0/71 [00:00<?, ?it/s]Top10:Epoch 19: train loss: 8.967	  train recall@20: 0.4752	  train NDCG: 0.2895	  train precision: 0.2406	  train hit: 0.8125	  train mrr: 0.2542
Top10:Epoch 19: valid loss: 8.768	  valid recall@20: 0.3404	  valid NDCG: 0.2661	  valid precision: 0.3361	  valid hit: 0.7532	  valid mrr: 0.234

Top20:Epoch 19: train loss: 8.967	  train recall@20: 0.5503	  train NDCG: 0.3102	  train precision: 0.1421	  train hit: 0.8623	  train mrr: 0.2602
Top20:Epoch 19: valid loss: 8.768	  valid recall@20: 0.3974	  valid NDCG: 0.284	  valid precision: 0.1977	  valid hit: 0.7703	  valid mrr: 0.2391

Top30:Epoch 19: train loss: 8.967	  train recall@20: 0.5926	  train NDCG: 0.3205	  train precision: 0.1037	  train hit: 0.8823	  train mrr: 0.2622
Top30:Epoch 19: valid loss: 8.768	  valid recall@20: 0.4341	  valid NDCG: 0.2942	  valid precision: 0.1452	  valid hit: 0.7788	  valid mrr: 0.2411


batch:   1%|▏         | 1/71 [01:17<1:30:24, 77.49s/it]
batch:   3%|▎         | 2/71 [01:24<41:26, 36.03s/it]  
batch:   4%|▍         | 3/71 [01:31<25:40, 22.65s/it]
batch:   6%|▌         | 4/71 [01:38<18:25, 16.50s/it]
batch:   7%|▋         | 5/71 [01:45<14:30, 13.19s/it]
batch:   8%|▊         | 6/71 [01:53<12:14, 11.29s/it]
batch:  10%|▉         | 7/71 [02:00<10:42, 10.04s/it]
batch:  11%|█▏        | 8/71 [03:16<32:38, 31.08s/it]
batch:  13%|█▎        | 9/71 [03:23<24:17, 23.51s/it]
batch:  14%|█▍        | 10/71 [03:30<18:42, 18.41s/it]
batch:  15%|█▌        | 11/71 [03:37<14:58, 14.97s/it]
batch:  17%|█▋        | 12/71 [03:44<12:14, 12.45s/it]
batch:  18%|█▊        | 13/71 [03:51<10:22, 10.73s/it]
batch:  20%|█▉        | 14/71 [03:58<09:02,  9.51s/it]
batch:  21%|██        | 15/71 [05:16<28:16, 30.30s/it]
batch:  23%|██▎       | 16/71 [05:23<21:26, 23.39s/it]
batch:  24%|██▍       | 17/71 [05:31<16:43, 18.59s/it]
batch:  25%|██▌       | 18/71 [05:38<13:30, 15.30s/it]
batch:  27%|██▋       | 19/71 [05:46<11:13, 12.95s/it]
batch:  28%|██▊       | 20/71 [05:54<09:44, 11.47s/it]
batch:  30%|██▉       | 21/71 [06:02<08:37, 10.35s/it]
batch:  31%|███       | 22/71 [07:22<25:37, 31.37s/it]
batch:  32%|███▏      | 23/71 [07:29<19:20, 24.17s/it]
batch:  34%|███▍      | 24/71 [07:37<15:00, 19.15s/it]
batch:  35%|███▌      | 25/71 [07:44<11:56, 15.58s/it]
batch:  37%|███▋      | 26/71 [07:52<09:53, 13.19s/it]
batch:  38%|███▊      | 27/71 [07:59<08:27, 11.53s/it]
batch:  39%|███▉      | 28/71 [08:07<07:21, 10.28s/it]
batch:  41%|████      | 29/71 [09:31<22:40, 32.40s/it]
batch:  42%|████▏     | 30/71 [09:38<17:03, 24.96s/it]
batch:  44%|████▎     | 31/71 [09:46<13:15, 19.89s/it]
batch:  45%|████▌     | 32/71 [09:54<10:35, 16.29s/it]
batch:  46%|████▋     | 33/71 [10:02<08:37, 13.61s/it]
batch:  48%|████▊     | 34/71 [10:09<07:14, 11.75s/it]
batch:  49%|████▉     | 35/71 [10:16<06:14, 10.39s/it]
batch:  51%|█████     | 36/71 [11:39<18:40, 32.00s/it]
batch:  52%|█████▏    | 37/71 [11:47<14:03, 24.81s/it]
batch:  54%|█████▎    | 38/71 [11:55<10:53, 19.80s/it]
batch:  55%|█████▍    | 39/71 [12:03<08:38, 16.19s/it]
batch:  56%|█████▋    | 40/71 [12:10<06:55, 13.41s/it]
batch:  58%|█████▊    | 41/71 [12:17<05:52, 11.76s/it]
batch:  59%|█████▉    | 42/71 [12:26<05:14, 10.85s/it]
batch:  61%|██████    | 43/71 [13:50<15:15, 32.68s/it]
batch:  62%|██████▏   | 44/71 [13:57<11:19, 25.16s/it]
batch:  63%|██████▎   | 45/71 [14:05<08:36, 19.87s/it]
batch:  65%|██████▍   | 46/71 [14:12<06:41, 16.07s/it]
batch:  66%|██████▌   | 47/71 [14:19<05:18, 13.26s/it]
batch:  68%|██████▊   | 48/71 [14:26<04:25, 11.54s/it]
batch:  69%|██████▉   | 49/71 [14:35<03:53, 10.61s/it]
batch:  70%|███████   | 50/71 [15:56<11:07, 31.77s/it]
batch:  72%|███████▏  | 51/71 [16:03<08:10, 24.50s/it]
batch:  73%|███████▎  | 52/71 [16:12<06:12, 19.60s/it]
batch:  75%|███████▍  | 53/71 [16:19<04:46, 15.92s/it]
batch:  76%|███████▌  | 54/71 [16:26<03:46, 13.30s/it]
batch:  77%|███████▋  | 55/71 [16:33<03:01, 11.33s/it]
batch:  79%|███████▉  | 56/71 [16:40<02:29,  9.99s/it]
batch:  80%|████████  | 57/71 [17:54<06:48, 29.15s/it]
batch:  82%|████████▏ | 58/71 [18:01<04:53, 22.61s/it]
batch:  83%|████████▎ | 59/71 [18:08<03:35, 17.93s/it]
batch:  85%|████████▍ | 60/71 [18:15<02:40, 14.58s/it]
batch:  86%|████████▌ | 61/71 [18:21<02:02, 12.23s/it]
batch:  87%|████████▋ | 62/71 [18:29<01:36, 10.76s/it]
batch:  89%|████████▊ | 63/71 [18:36<01:17,  9.72s/it]
batch:  90%|█████████ | 64/71 [19:49<03:20, 28.60s/it]
batch:  92%|█████████▏| 65/71 [19:56<02:12, 22.13s/it]
batch:  93%|█████████▎| 66/71 [20:04<01:29, 17.92s/it]
batch:  94%|█████████▍| 67/71 [20:12<00:59, 14.85s/it]
batch:  96%|█████████▌| 68/71 [20:19<00:37, 12.61s/it]
batch:  97%|█████████▋| 69/71 [20:27<00:22, 11.17s/it]
batch:  99%|█████████▊| 70/71 [20:35<00:10, 10.19s/it]
batch: 100%|██████████| 71/71 [21:54<00:00, 30.78s/it]
Top10:Epoch 20: train loss: 8.937	  train recall@20: 0.4813	  train NDCG: 0.2959	  train precision: 0.2458	  train hit: 0.8132	  train mrr: 0.2601
Top10:Epoch 20: valid loss: 8.833	  valid recall@20: 0.3472	  valid NDCG: 0.2737	  valid precision: 0.3436	  valid hit: 0.7535	  valid mrr: 0.2416

Top20:Epoch 20: train loss: 8.937	  train recall@20: 0.5558	  train NDCG: 0.3169	  train precision: 0.145	  train hit: 0.8624	  train mrr: 0.2662
Top20:Epoch 20: valid loss: 8.833	  valid recall@20: 0.4069	  valid NDCG: 0.2926	  valid precision: 0.2026	  valid hit: 0.7732	  valid mrr: 0.247

Top30:Epoch 20: train loss: 8.937	  train recall@20: 0.5996	  train NDCG: 0.3274	  train precision: 0.1057	  train hit: 0.8835	  train mrr: 0.2683
Top30:Epoch 20: valid loss: 8.833	  valid recall@20: 0.4438	  valid NDCG: 0.3025	  valid precision: 0.1483	  valid hit: 0.7818	  valid mrr: 0.2489

2023-02-13 17:48:00.952 | INFO     | __main__:main:146 - The model has been trained. The test loss is 8.59 and recall_k is 0.3515 and ndcg is 0.2729and precision is 0.3571and hit is 0.7617and mrr is 0.2404.
2023-02-13 17:48:00.952 | INFO     | __main__:main:149 - The model has been trained. The test loss is 8.59 and recall_k is 0.4105 and ndcg is 0.292and precision is 0.21and hit is 0.7813and mrr is 0.2459.
2023-02-13 17:48:00.953 | INFO     | __main__:main:152 - The model has been trained. The test loss is 8.59 and recall_k is 0.449 and ndcg is 0.3023and precision is 0.1542and hit is 0.7897and mrr is 0.2479.

Process finished with exit code 0
